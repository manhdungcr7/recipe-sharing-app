{"ast":null,"code":"// Tạo file utility để xử lý API requests\nexport const getAuthToken = () => {\n  return localStorage.getItem('token');\n};\nexport const getAuthHeaders = () => {\n  const token = getAuthToken();\n  return token ? {\n    'Authorization': `Bearer ${token}`\n  } : {};\n};\nexport const apiRequest = async (url, options = {}) => {\n  const token = getAuthToken();\n  const headers = {\n    ...options.headers,\n    ...(token ? {\n      'Authorization': `Bearer ${token}`\n    } : {})\n  };\n  const response = await fetch(`http://localhost:5000${url}`, {\n    ...options,\n    headers\n  });\n  if (response.status === 401) {\n    // Token hết hạn hoặc không hợp lệ\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n\n    // Lưu đường dẫn hiện tại để quay lại sau khi đăng nhập\n    localStorage.setItem('redirectAfterLogin', window.location.pathname);\n\n    // Chuyển hướng đến trang đăng nhập\n    window.location.href = '/login';\n    throw new Error('Token hết hạn. Vui lòng đăng nhập lại.');\n  }\n  return response;\n};","map":{"version":3,"names":["getAuthToken","localStorage","getItem","getAuthHeaders","token","apiRequest","url","options","headers","response","fetch","status","removeItem","setItem","window","location","pathname","href","Error"],"sources":["C:/Users/Lenovo/Documents/web_SE/recipe-sharing-app/src/utils/apiUtils.js"],"sourcesContent":["// Tạo file utility để xử lý API requests\r\nexport const getAuthToken = () => {\r\n  return localStorage.getItem('token');\r\n};\r\n\r\nexport const getAuthHeaders = () => {\r\n  const token = getAuthToken();\r\n  return token ? { 'Authorization': `Bearer ${token}` } : {};\r\n};\r\n\r\nexport const apiRequest = async (url, options = {}) => {\r\n  const token = getAuthToken();\r\n  \r\n  const headers = {\r\n    ...options.headers,\r\n    ...(token ? { 'Authorization': `Bearer ${token}` } : {})\r\n  };\r\n  \r\n  const response = await fetch(`http://localhost:5000${url}`, {\r\n    ...options,\r\n    headers\r\n  });\r\n  \r\n  if (response.status === 401) {\r\n    // Token hết hạn hoặc không hợp lệ\r\n    localStorage.removeItem('token');\r\n    localStorage.removeItem('user');\r\n    \r\n    // Lưu đường dẫn hiện tại để quay lại sau khi đăng nhập\r\n    localStorage.setItem('redirectAfterLogin', window.location.pathname);\r\n    \r\n    // Chuyển hướng đến trang đăng nhập\r\n    window.location.href = '/login';\r\n    throw new Error('Token hết hạn. Vui lòng đăng nhập lại.');\r\n  }\r\n  \r\n  return response;\r\n};"],"mappings":"AAAA;AACA,OAAO,MAAMA,YAAY,GAAGA,CAAA,KAAM;EAChC,OAAOC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;AACtC,CAAC;AAED,OAAO,MAAMC,cAAc,GAAGA,CAAA,KAAM;EAClC,MAAMC,KAAK,GAAGJ,YAAY,CAAC,CAAC;EAC5B,OAAOI,KAAK,GAAG;IAAE,eAAe,EAAE,UAAUA,KAAK;EAAG,CAAC,GAAG,CAAC,CAAC;AAC5D,CAAC;AAED,OAAO,MAAMC,UAAU,GAAG,MAAAA,CAAOC,GAAG,EAAEC,OAAO,GAAG,CAAC,CAAC,KAAK;EACrD,MAAMH,KAAK,GAAGJ,YAAY,CAAC,CAAC;EAE5B,MAAMQ,OAAO,GAAG;IACd,GAAGD,OAAO,CAACC,OAAO;IAClB,IAAIJ,KAAK,GAAG;MAAE,eAAe,EAAE,UAAUA,KAAK;IAAG,CAAC,GAAG,CAAC,CAAC;EACzD,CAAC;EAED,MAAMK,QAAQ,GAAG,MAAMC,KAAK,CAAC,wBAAwBJ,GAAG,EAAE,EAAE;IAC1D,GAAGC,OAAO;IACVC;EACF,CAAC,CAAC;EAEF,IAAIC,QAAQ,CAACE,MAAM,KAAK,GAAG,EAAE;IAC3B;IACAV,YAAY,CAACW,UAAU,CAAC,OAAO,CAAC;IAChCX,YAAY,CAACW,UAAU,CAAC,MAAM,CAAC;;IAE/B;IACAX,YAAY,CAACY,OAAO,CAAC,oBAAoB,EAAEC,MAAM,CAACC,QAAQ,CAACC,QAAQ,CAAC;;IAEpE;IACAF,MAAM,CAACC,QAAQ,CAACE,IAAI,GAAG,QAAQ;IAC/B,MAAM,IAAIC,KAAK,CAAC,wCAAwC,CAAC;EAC3D;EAEA,OAAOT,QAAQ;AACjB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}