{"ast":null,"code":"// Monkey patch fetch để tự động thêm token\nconst originalFetch = window.fetch;\nwindow.fetch = async (url, options = {}) => {\n  // Nếu là URL tương đối hoặc từ localhost:5000\n  if (url.includes('/api/') || url.includes('localhost:5000')) {\n    const token = localStorage.getItem('token');\n\n    // Chỉ thêm token nếu có và không phải null/undefined\n    if (token && token !== 'undefined' && token !== 'null') {\n      options = {\n        ...options,\n        headers: {\n          ...options.headers,\n          'Authorization': `Bearer ${token}`\n        }\n      };\n      console.log(`Fetch to ${url} with token: ${token.substring(0, 10)}...`);\n    } else {\n      console.log(`Fetch to ${url} without token`);\n      // Không thêm header Authorization nếu không có token hợp lệ\n    }\n  }\n  return originalFetch(url, options);\n};\nexport default function setupFetchInterceptor() {\n  // Phương thức này được gọi trong App.jsx để thiết lập interceptor\n  console.log('Fetch interceptor set up');\n}","map":{"version":3,"names":["originalFetch","window","fetch","url","options","includes","token","localStorage","getItem","headers","console","log","substring","setupFetchInterceptor"],"sources":["C:/Users/Lenovo/Documents/web_SE/recipe-sharing-app/src/utils/fetchInterceptor.js"],"sourcesContent":["// Monkey patch fetch để tự động thêm token\r\nconst originalFetch = window.fetch;\r\n\r\nwindow.fetch = async (url, options = {}) => {\r\n  // Nếu là URL tương đối hoặc từ localhost:5000\r\n  if (url.includes('/api/') || url.includes('localhost:5000')) {\r\n    const token = localStorage.getItem('token');\r\n    \r\n    // Chỉ thêm token nếu có và không phải null/undefined\r\n    if (token && token !== 'undefined' && token !== 'null') {\r\n      options = {\r\n        ...options,\r\n        headers: {\r\n          ...options.headers,\r\n          'Authorization': `Bearer ${token}`\r\n        }\r\n      };\r\n      console.log(`Fetch to ${url} with token: ${token.substring(0, 10)}...`);\r\n    } else {\r\n      console.log(`Fetch to ${url} without token`);\r\n      // Không thêm header Authorization nếu không có token hợp lệ\r\n    }\r\n  }\r\n  \r\n  return originalFetch(url, options);\r\n};\r\n\r\nexport default function setupFetchInterceptor() {\r\n  // Phương thức này được gọi trong App.jsx để thiết lập interceptor\r\n  console.log('Fetch interceptor set up');\r\n}"],"mappings":"AAAA;AACA,MAAMA,aAAa,GAAGC,MAAM,CAACC,KAAK;AAElCD,MAAM,CAACC,KAAK,GAAG,OAAOC,GAAG,EAAEC,OAAO,GAAG,CAAC,CAAC,KAAK;EAC1C;EACA,IAAID,GAAG,CAACE,QAAQ,CAAC,OAAO,CAAC,IAAIF,GAAG,CAACE,QAAQ,CAAC,gBAAgB,CAAC,EAAE;IAC3D,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;;IAE3C;IACA,IAAIF,KAAK,IAAIA,KAAK,KAAK,WAAW,IAAIA,KAAK,KAAK,MAAM,EAAE;MACtDF,OAAO,GAAG;QACR,GAAGA,OAAO;QACVK,OAAO,EAAE;UACP,GAAGL,OAAO,CAACK,OAAO;UAClB,eAAe,EAAE,UAAUH,KAAK;QAClC;MACF,CAAC;MACDI,OAAO,CAACC,GAAG,CAAC,YAAYR,GAAG,gBAAgBG,KAAK,CAACM,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC,KAAK,CAAC;IACzE,CAAC,MAAM;MACLF,OAAO,CAACC,GAAG,CAAC,YAAYR,GAAG,gBAAgB,CAAC;MAC5C;IACF;EACF;EAEA,OAAOH,aAAa,CAACG,GAAG,EAAEC,OAAO,CAAC;AACpC,CAAC;AAED,eAAe,SAASS,qBAAqBA,CAAA,EAAG;EAC9C;EACAH,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAC;AACzC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}