{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Lenovo\\\\Documents\\\\web_SE\\\\recipe-sharing-app\\\\src\\\\pages\\\\CreateRecipePage.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport './CreateRecipePage.css';\nimport { getAuthToken, getAuthHeaders, apiRequest } from '../utils/apiUtils';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CreateRecipePage = () => {\n  _s();\n  const navigate = useNavigate();\n  const [title, setTitle] = useState('');\n  const [image, setImage] = useState(null);\n  const [imagePreview, setImagePreview] = useState(null);\n  const [cookingTime, setCookingTime] = useState('');\n  const [thoughts, setThoughts] = useState('');\n  const [ingredients, setIngredients] = useState([{\n    name: '',\n    quantity: '',\n    unit: ''\n  }]);\n  const [steps, setSteps] = useState([{\n    description: '',\n    image: null,\n    video: null,\n    imagePreview: null\n  }]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [success, setSuccess] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [submitting, setSubmitting] = useState(false);\n  useEffect(() => {\n    // Kiểm tra đăng nhập trước khi làm gì khác\n    const token = getAuthToken();\n    if (!token) {\n      alert(\"Bạn cần đăng nhập để tạo công thức mới\");\n      // Lưu đường dẫn hiện tại để quay lại sau khi đăng nhập\n      localStorage.setItem('redirectAfterLogin', '/create-recipe');\n      // Chuyển hướng đến trang đăng nhập\n      navigate('/login');\n      return;\n    }\n\n    // Nếu có dữ liệu đã lưu, khôi phục\n    const savedForm = localStorage.getItem('recipeFormData');\n    if (savedForm) {\n      try {\n        var _formData$steps;\n        const formData = JSON.parse(savedForm);\n        setTitle(formData.title || '');\n        setCookingTime(formData.cookingTime || '');\n        setThoughts(formData.thoughts || '');\n        setIngredients(formData.ingredients || [{\n          name: '',\n          quantity: '',\n          unit: ''\n        }]);\n\n        // Khôi phục bước mà không khôi phục hình ảnh/video\n        // Vì localStorage không thể lưu file\n        setSteps(((_formData$steps = formData.steps) === null || _formData$steps === void 0 ? void 0 : _formData$steps.map(step => ({\n          ...step,\n          image: null,\n          video: null,\n          imagePreview: null\n        }))) || [{\n          description: '',\n          image: null,\n          video: null,\n          imagePreview: null\n        }]);\n\n        // Đã khôi phục xong, xóa data\n        localStorage.removeItem('recipeFormData');\n        alert(\"Đã khôi phục dữ liệu công thức bạn đang soạn thảo!\");\n      } catch (e) {\n        console.error(\"Error restoring form:\", e);\n      }\n    }\n  }, [navigate]);\n  useEffect(() => {\n    // Kiểm tra xem có dữ liệu đã lưu không\n    const savedData = localStorage.getItem('pendingRecipeData');\n    if (savedData) {\n      try {\n        var _data$steps;\n        const data = JSON.parse(savedData);\n        setTitle(data.title || '');\n        setCookingTime(data.cookingTime || '');\n        setThoughts(data.thoughts || '');\n        setIngredients(data.ingredients || [{\n          name: '',\n          quantity: '',\n          unit: ''\n        }]);\n\n        // Khôi phục bước mà không khôi phục hình ảnh/video\n        setSteps(((_data$steps = data.steps) === null || _data$steps === void 0 ? void 0 : _data$steps.map(step => ({\n          ...step,\n          image: null,\n          video: null,\n          imagePreview: null\n        }))) || [{\n          description: '',\n          image: null,\n          video: null,\n          imagePreview: null\n        }]);\n\n        // Đã khôi phục xong, xóa data\n        localStorage.removeItem('pendingRecipeData');\n        alert('Đã khôi phục công thức bạn đang soạn trước đó!');\n      } catch (e) {\n        console.error('Error restoring recipe data:', e);\n      }\n    }\n  }, []);\n\n  // Tự động lưu form data mỗi 30 giây\n  useEffect(() => {\n    const autoSaveInterval = setInterval(() => {\n      if (title || cookingTime || ingredients.length > 1 || steps.length > 1) {\n        const formData = {\n          title,\n          cookingTime,\n          thoughts,\n          ingredients,\n          // Lưu mô tả của bước nhưng không lưu file\n          steps: steps.map(step => ({\n            description: step.description\n          }))\n        };\n        localStorage.setItem('pendingRecipeData', JSON.stringify(formData));\n        console.log('Form data auto-saved');\n      }\n    }, 30000);\n    return () => clearInterval(autoSaveInterval);\n  }, [title, cookingTime, thoughts, ingredients, steps]);\n\n  // Xử lý thêm nguyên liệu\n  const handleAddIngredient = () => {\n    setIngredients([...ingredients, {\n      name: '',\n      quantity: '',\n      unit: ''\n    }]);\n  };\n\n  // Xử lý xóa nguyên liệu\n  const handleRemoveIngredient = index => {\n    if (ingredients.length > 1) {\n      const newIngredients = [...ingredients];\n      newIngredients.splice(index, 1);\n      setIngredients(newIngredients);\n    }\n  };\n\n  // Xử lý thêm bước\n  const handleAddStep = () => {\n    setSteps([...steps, {\n      description: '',\n      image: null,\n      video: null,\n      imagePreview: null\n    }]);\n  };\n\n  // Xử lý xóa bước\n  const handleRemoveStep = index => {\n    if (steps.length > 1) {\n      const newSteps = [...steps];\n      newSteps.splice(index, 1);\n      setSteps(newSteps);\n    }\n  };\n\n  // Xử lý thay đổi nguyên liệu\n  const handleIngredientChange = (index, field, value) => {\n    const newIngredients = [...ingredients];\n    newIngredients[index][field] = value;\n    setIngredients(newIngredients);\n  };\n\n  // Xử lý thay đổi bước\n  const handleStepChange = (index, value) => {\n    const newSteps = [...steps];\n    newSteps[index].description = value;\n    setSteps(newSteps);\n  };\n\n  // Xử lý thay đổi hình ảnh cho bước\n  const handleStepImageChange = (index, e) => {\n    const file = e.target.files[0];\n    if (!file) return;\n\n    // Kiểm tra kích thước file (giới hạn 5MB)\n    if (file.size > 5 * 1024 * 1024) {\n      alert('Kích thước file quá lớn. Vui lòng chọn file nhỏ hơn 5MB.');\n      return;\n    }\n\n    // Kiểm tra loại file\n    if (!file.type.startsWith('image/')) {\n      alert('Vui lòng chọn file hình ảnh.');\n      return;\n    }\n    const newSteps = [...steps];\n    newSteps[index].image = file;\n\n    // Tạo preview của hình ảnh\n    const reader = new FileReader();\n    reader.onloadend = () => {\n      newSteps[index].imagePreview = reader.result;\n      setSteps(newSteps);\n    };\n    reader.readAsDataURL(file);\n  };\n\n  // Xử lý thay đổi video cho bước\n  const handleStepVideoChange = (index, e) => {\n    const file = e.target.files[0];\n    if (!file) return;\n\n    // Kiểm tra kích thước file (giới hạn 50MB cho video)\n    if (file.size > 50 * 1024 * 1024) {\n      alert('Kích thước video quá lớn. Vui lòng chọn file nhỏ hơn 50MB.');\n      return;\n    }\n\n    // Kiểm tra loại file\n    if (!file.type.startsWith('video/')) {\n      alert('Vui lòng chọn file video.');\n      return;\n    }\n    const newSteps = [...steps];\n    newSteps[index].video = file;\n    setSteps(newSteps);\n  };\n\n  // Xử lý thay đổi hình ảnh chính\n  const handleImageChange = e => {\n    const file = e.target.files[0];\n    if (!file) return;\n\n    // Kiểm tra kích thước file (giới hạn 5MB)\n    if (file.size > 5 * 1024 * 1024) {\n      alert('Kích thước file quá lớn. Vui lòng chọn file nhỏ hơn 5MB.');\n      return;\n    }\n    setImage(file);\n\n    // Tạo preview của hình ảnh\n    const reader = new FileReader();\n    reader.onloadend = () => {\n      setImagePreview(reader.result);\n    };\n    reader.readAsDataURL(file);\n  };\n\n  // Sửa hàm getAuthToken\n  const getAuthToken = () => {\n    // THỐNG NHẤT SỬ DỤNG KEY 'token'\n    const token = localStorage.getItem('token');\n    if (!token) {\n      console.error(\"No auth token found in localStorage\");\n      return null;\n    }\n    console.log(\"Auth token found in localStorage:\", token.substring(0, 10) + \"...\");\n    return token;\n  };\n\n  // Kiểm tra trạng thái đăng nhập\n  useEffect(() => {\n    const checkAuthStatus = async () => {\n      const token = getAuthToken();\n      if (!token) {\n        alert(\"Bạn cần đăng nhập để tạo công thức mới\");\n        localStorage.setItem('redirectAfterLogin', '/create-recipe');\n        navigate('/login');\n        return;\n      }\n\n      // Kiểm tra token có hợp lệ không thông qua API\n      try {\n        var _data$data;\n        const response = await apiRequest('/api/auth/me');\n        if (!response.ok) {\n          // Token không hợp lệ hoặc hết hạn\n          localStorage.removeItem('token');\n          localStorage.setItem('redirectAfterLogin', '/create-recipe');\n          alert(\"Phiên đăng nhập đã hết hạn. Vui lòng đăng nhập lại.\");\n          navigate('/login');\n          return;\n        }\n\n        // Token hợp lệ - tiếp tục với trang tạo công thức\n        const data = await response.json();\n        console.log(\"Authenticated as:\", ((_data$data = data.data) === null || _data$data === void 0 ? void 0 : _data$data.name) || \"Unknown user\");\n      } catch (error) {\n        console.error(\"Error checking authentication:\", error);\n        // Không chuyển hướng trong trường hợp lỗi mạng\n        setError(\"Không thể kiểm tra trạng thái đăng nhập. Vui lòng kiểm tra kết nối mạng.\");\n      }\n    };\n    checkAuthStatus();\n  }, [navigate]);\n\n  // Xử lý nút \"Đăng công thức\"\n  const handlePublishRecipe = async () => {\n    try {\n      var _data$data2;\n      // Validate dữ liệu đầu vào\n\n      setIsSubmitting(true);\n\n      // Lấy token xác thực\n      const token = getAuthToken();\n      if (!token) {\n        setError(\"Bạn cần đăng nhập để đăng công thức. Đang chuyển hướng...\");\n        setIsSubmitting(false);\n\n        // Lưu đường dẫn hiện tại để quay lại sau khi đăng nhập\n        localStorage.setItem('redirectAfterLogin', '/create-recipe');\n\n        // Chờ 2 giây trước khi chuyển hướng\n        setTimeout(() => {\n          navigate('/login');\n        }, 2000);\n        return;\n      }\n      const formData = new FormData();\n\n      // Thêm các trường dữ liệu\n      formData.append('title', title);\n      formData.append('cookingTime', cookingTime);\n      formData.append('thoughts', thoughts);\n      formData.append('status', 'published');\n\n      // Thêm hình ảnh chính\n      if (image) {\n        formData.append('image', image);\n      }\n\n      // Thêm các nguyên liệu\n      formData.append('ingredients', JSON.stringify(ingredients));\n\n      // Thêm các bước\n      formData.append('steps', JSON.stringify(steps.map(step => ({\n        description: step.description\n      }))));\n\n      // Thêm hình ảnh và video cho từng bước\n      steps.forEach((step, index) => {\n        if (step.image) {\n          formData.append(`step_images[${index}]`, step.image);\n        }\n        if (step.video) {\n          formData.append(`step_videos[${index}]`, step.video);\n        }\n      });\n\n      // Log data để debug\n      console.log(\"Sending with token:\", token.substring(0, 15) + \"...\");\n\n      // Gửi request với token trong header\n      const response = await fetch('http://localhost:5000/api/recipes', {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        },\n        body: formData\n      });\n\n      // Kiểm tra response có phải là JSON không\n      const contentType = response.headers.get('content-type');\n      let data;\n      if (contentType && contentType.includes('application/json')) {\n        data = await response.json();\n      } else {\n        const text = await response.text();\n        console.error(\"Server returned non-JSON response:\", text);\n        throw new Error(\"Máy chủ trả về dữ liệu không hợp lệ\");\n      }\n      if (!response.ok) {\n        // Kiểm tra lỗi 401\n        if (response.status === 401) {\n          // Token hết hạn hoặc không hợp lệ\n          localStorage.removeItem('token');\n          localStorage.setItem('redirectAfterLogin', '/create-recipe');\n          setError(\"Phiên đăng nhập đã hết hạn. Vui lòng đăng nhập lại.\");\n          setTimeout(() => {\n            navigate('/login');\n          }, 2000);\n          return;\n        }\n        throw new Error(data.message || 'Không thể tạo công thức');\n      }\n\n      // Xử lý thành công\n      setSuccess(true);\n\n      // Lấy ID công thức từ response\n      const recipeId = (_data$data2 = data.data) === null || _data$data2 === void 0 ? void 0 : _data$data2.id;\n      console.log(\"Created recipe with ID:\", recipeId);\n      if (!recipeId) {\n        console.error(\"Recipe ID not found in response:\", data);\n      }\n\n      // Chuyển đến trang chi tiết công thức với ID đúng\n      setTimeout(() => {\n        navigate(`/recipe/${recipeId}`);\n      }, 2000);\n    } catch (error) {\n      console.error(\"Error creating recipe:\", error);\n      setError(error.message || \"Đã có lỗi xảy ra khi tạo công thức\");\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  // Xử lý nút \"Lưu bản nháp\"\n  const handleSaveDraft = async () => {\n    if (!title) {\n      setError('Vui lòng nhập tên món ăn');\n      return;\n    }\n    try {\n      setLoading(true);\n      setError(null);\n\n      // Lấy token bằng hàm getAuthToken đã chuẩn hóa\n      const token = getAuthToken();\n      if (!token) {\n        setError(\"Bạn cần đăng nhập để lưu bản nháp công thức\");\n        setLoading(false);\n        return;\n      }\n\n      // Tạo FormData để gửi cả file và dữ liệu\n      const formData = new FormData();\n      formData.append('title', title);\n      formData.append('cookingTime', cookingTime || '0');\n      formData.append('thoughts', thoughts || '');\n      formData.append('status', 'draft'); // Trạng thái bản nháp\n\n      // Thêm hình ảnh món ăn nếu có\n      if (image) {\n        formData.append('image', image);\n      }\n\n      // Thêm nguyên liệu dưới dạng JSON (có thể rỗng cho bản nháp)\n      formData.append('ingredients', JSON.stringify(ingredients));\n\n      // Chuẩn bị steps (không có hình ảnh/video lúc này)\n      const stepsData = steps.map(step => ({\n        description: step.description || ''\n      }));\n      formData.append('steps', JSON.stringify(stepsData));\n\n      // Thêm step images và videos riêng biệt\n      steps.forEach((step, index) => {\n        if (step.image) {\n          formData.append(`step_images[${index}]`, step.image);\n        }\n        if (step.video) {\n          formData.append(`step_videos[${index}]`, step.video);\n        }\n      });\n      const response = await fetch('http://localhost:5000/api/recipes/draft', {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        },\n        body: formData\n      });\n      if (response.ok) {\n        const result = await response.json();\n\n        // Xóa dữ liệu công thức đã lưu\n        localStorage.removeItem('recipeFormData');\n        localStorage.removeItem('pendingRecipeData');\n\n        // Hiển thị thông báo thành công\n        alert('Công thức đã được lưu dưới dạng bản nháp');\n\n        // Chuyển hướng về dashboard\n        navigate('/dashboard');\n      } else {\n        const result = await response.json();\n        throw new Error(result.message || 'Lỗi khi lưu bản nháp');\n      }\n    } catch (error) {\n      setError(`Lỗi: ${error.message}`);\n      console.error(\"Error saving draft:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Xử lý nút \"Đăng công thức\" - phiên bản mới\n  const handleSubmit = async e => {\n    e.preventDefault();\n    try {\n      // Lưu công thức hiện tại vào localStorage trước khi gửi\n      const recipeData = {\n        title,\n        cookingTime,\n        ingredients,\n        steps,\n        thoughts\n      };\n      localStorage.setItem('recipe_draft', JSON.stringify(recipeData));\n      setIsSubmitting(true);\n\n      // Chuẩn bị dữ liệu gửi lên\n      const formData = new FormData();\n      formData.append('title', title);\n      formData.append('cookingTime', cookingTime);\n      formData.append('thoughts', thoughts);\n      formData.append('status', 'published');\n\n      // Thêm hình ảnh chính\n      if (image) {\n        formData.append('image', image);\n      }\n\n      // Thêm các nguyên liệu\n      formData.append('ingredients', JSON.stringify(ingredients));\n\n      // Thêm các bước\n      formData.append('steps', JSON.stringify(steps.map(step => ({\n        description: step.description\n      }))));\n\n      // Thêm hình ảnh và video cho từng bước\n      steps.forEach((step, index) => {\n        if (step.image) {\n          formData.append(`step_images[${index}]`, step.image);\n        }\n        if (step.video) {\n          formData.append(`step_videos[${index}]`, step.video);\n        }\n      });\n\n      // Lấy token đúng\n      const token = localStorage.getItem('auth_token'); // Sử dụng auth_token thống nhất\n\n      // Kiểm tra token trước khi gửi request\n      if (!token) {\n        setError('Không tìm thấy thông tin xác thực. Vui lòng đăng nhập lại.');\n        localStorage.removeItem('user');\n        navigate('/login');\n        return;\n      }\n      const response = await fetch('http://localhost:5000/api/recipes', {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        },\n        body: formData\n      });\n      if (response.ok) {\n        const data = await response.json();\n        alert('Công thức đã được tạo thành công!');\n        navigate(`/recipe/${data.id}`);\n      } else {\n        // Xử lý khi server trả về lỗi\n        const errorData = await response.json();\n\n        // Nếu token không hợp lệ, chuyển về trang đăng nhập\n        if (response.status === 401) {\n          setError('Phiên đăng nhập đã hết hạn. Vui lòng đăng nhập lại.');\n          localStorage.removeItem('auth_token');\n          localStorage.removeItem('user');\n          setTimeout(() => navigate('/login'), 2000);\n          return;\n        }\n        setError(errorData.message || 'Có lỗi xảy ra khi tạo công thức.');\n      }\n    } catch (err) {\n      console.error('Error creating recipe:', err);\n      setError('Lỗi kết nối đến server. Vui lòng thử lại sau.');\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"create-recipe-page\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"T\\u1EA1o c\\xF4ng th\\u1EE9c m\\u1EDBi\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 566,\n      columnNumber: 13\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-message\",\n      children: [/*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"fas fa-exclamation-circle\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 570,\n        columnNumber: 5\n      }, this), error]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 569,\n      columnNumber: 3\n    }, this), submitting && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"overlay\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading-spinner\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"spinner\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 578,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"\\u0110ang t\\u1EA1o c\\xF4ng th\\u1EE9c...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 579,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 577,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 576,\n      columnNumber: 3\n    }, this), success && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"success-message\",\n      children: \"C\\xF4ng th\\u1EE9c \\u0111\\xE3 \\u0111\\u01B0\\u1EE3c \\u0111\\u0103ng th\\xE0nh c\\xF4ng!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 584,\n      columnNumber: 25\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      className: \"recipe-form\",\n      encType: \"multipart/form-data\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"title\",\n          children: \"T\\xEAn m\\xF3n \\u0103n *\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 589,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          id: \"title\",\n          value: title,\n          onChange: e => setTitle(e.target.value),\n          placeholder: \"Nh\\u1EADp t\\xEAn m\\xF3n \\u0103n\",\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 590,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 588,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"image\",\n          children: \"H\\xECnh \\u1EA3nh m\\xF3n \\u0103n\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 602,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          id: \"image\",\n          accept: \"image/*\",\n          onChange: handleImageChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 603,\n          columnNumber: 21\n        }, this), imagePreview && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"image-preview\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: imagePreview,\n            alt: \"Xem tr\\u01B0\\u1EDBc\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 611,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 610,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 601,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"cookingTime\",\n          children: \"Th\\u1EDDi gian n\\u1EA5u (ph\\xFAt) *\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 618,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          id: \"cookingTime\",\n          value: cookingTime,\n          onChange: e => setCookingTime(e.target.value),\n          min: \"1\",\n          placeholder: \"Nh\\u1EADp th\\u1EDDi gian n\\u1EA5u\",\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 619,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 617,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Nguy\\xEAn li\\u1EC7u *\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 632,\n          columnNumber: 21\n        }, this), ingredients.map((ingredient, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ingredient-row\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: \"T\\xEAn nguy\\xEAn li\\u1EC7u\",\n            value: ingredient.name,\n            onChange: e => handleIngredientChange(index, 'name', e.target.value),\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 635,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: \"S\\u1ED1 l\\u01B0\\u1EE3ng\",\n            value: ingredient.quantity,\n            onChange: e => handleIngredientChange(index, 'quantity', e.target.value),\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 642,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: \"\\u0110\\u01A1n v\\u1ECB (g, ml...)\",\n            value: ingredient.unit,\n            onChange: e => handleIngredientChange(index, 'unit', e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 649,\n            columnNumber: 29\n          }, this), ingredients.length > 1 && /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"btn-remove\",\n            onClick: () => handleRemoveIngredient(index),\n            children: /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fas fa-times\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 661,\n              columnNumber: 37\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 656,\n            columnNumber: 33\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 634,\n          columnNumber: 25\n        }, this)), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: \"btn-add\",\n          onClick: handleAddIngredient,\n          children: [/*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fas fa-plus\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 667,\n            columnNumber: 25\n          }, this), \" Th\\xEAm nguy\\xEAn li\\u1EC7u\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 666,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 631,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"C\\xE1c b\\u01B0\\u1EDBc *\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 673,\n          columnNumber: 21\n        }, this), steps.map((step, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"step-row\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"step-header\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"step-number\",\n              children: [\"B\\u01B0\\u1EDBc \", index + 1]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 677,\n              columnNumber: 33\n            }, this), steps.length > 1 && /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"btn-remove\",\n              onClick: () => handleRemoveStep(index),\n              children: /*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fas fa-times\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 684,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 679,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 676,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            placeholder: `Mô tả chi tiết cho bước ${index + 1}`,\n            value: step.description || '',\n            onChange: e => handleStepChange(index, e.target.value),\n            required: true,\n            rows: \"3\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 688,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"step-media\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"media-input\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fas fa-image\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 698,\n                  columnNumber: 41\n                }, this), \" Th\\xEAm h\\xECnh \\u1EA3nh\", /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"file\",\n                  accept: \"image/*\",\n                  onChange: e => handleStepImageChange(index, e),\n                  style: {\n                    display: 'none'\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 699,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 697,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fas fa-video\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 707,\n                  columnNumber: 41\n                }, this), \" Th\\xEAm video\", /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"file\",\n                  accept: \"video/*\",\n                  onChange: e => handleStepVideoChange(index, e),\n                  style: {\n                    display: 'none'\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 708,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 706,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 696,\n              columnNumber: 33\n            }, this), step.imagePreview && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"media-preview\",\n              children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                src: step.imagePreview,\n                alt: `Bước ${index + 1}`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 719,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: \"btn-remove-media\",\n                onClick: () => {\n                  const newSteps = [...steps];\n                  newSteps[index].image = null;\n                  newSteps[index].imagePreview = null;\n                  setSteps(newSteps);\n                },\n                children: /*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fas fa-times\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 730,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 720,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 718,\n              columnNumber: 37\n            }, this), step.video && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"media-preview\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"video-info\",\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fas fa-film\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 738,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: step.video.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 739,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  className: \"btn-remove-media\",\n                  onClick: () => {\n                    const newSteps = [...steps];\n                    newSteps[index].video = null;\n                    setSteps(newSteps);\n                  },\n                  children: /*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"fas fa-times\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 749,\n                    columnNumber: 49\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 740,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 737,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 736,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 695,\n            columnNumber: 29\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 675,\n          columnNumber: 25\n        }, this)), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: \"btn-add\",\n          onClick: handleAddStep,\n          children: [/*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fas fa-plus\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 758,\n            columnNumber: 25\n          }, this), \" Th\\xEAm b\\u01B0\\u1EDBc\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 757,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 672,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"thoughts\",\n          children: \"Suy ngh\\u0129 v\\xE0 c\\u1EA3m nh\\u1EADn v\\u1EC1 m\\xF3n \\u0103n\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 764,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          id: \"thoughts\",\n          value: thoughts || '',\n          onChange: e => setThoughts(e.target.value),\n          placeholder: \"Chia s\\u1EBB c\\xE2u chuy\\u1EC7n, c\\u1EA3m nh\\u1EADn c\\u1EE7a b\\u1EA1n v\\u1EC1 m\\xF3n \\u0103n n\\xE0y...\",\n          rows: 4\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 765,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 763,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-actions\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: \"secondary-button\",\n          disabled: loading,\n          onClick: handleSaveDraft,\n          children: [/*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fas fa-save\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 782,\n            columnNumber: 25\n          }, this), \" L\\u01B0u b\\u1EA3n nh\\xE1p\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 776,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: \"primary-button\",\n          disabled: loading || isSubmitting,\n          children: [/*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fas fa-paper-plane\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 790,\n            columnNumber: 25\n          }, this), \" \", loading ? 'Đang xử lý...' : 'Đăng công thức']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 785,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 775,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 586,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 565,\n    columnNumber: 9\n  }, this);\n};\n_s(CreateRecipePage, \"ZrqdO9FhujVcbSpKv4gRzKQrV18=\", false, function () {\n  return [useNavigate];\n});\n_c = CreateRecipePage;\nexport default CreateRecipePage;\nvar _c;\n$RefreshReg$(_c, \"CreateRecipePage\");","map":{"version":3,"names":["React","useState","useEffect","useNavigate","getAuthToken","getAuthHeaders","apiRequest","jsxDEV","_jsxDEV","CreateRecipePage","_s","navigate","title","setTitle","image","setImage","imagePreview","setImagePreview","cookingTime","setCookingTime","thoughts","setThoughts","ingredients","setIngredients","name","quantity","unit","steps","setSteps","description","video","loading","setLoading","error","setError","success","setSuccess","isSubmitting","setIsSubmitting","submitting","setSubmitting","token","alert","localStorage","setItem","savedForm","getItem","_formData$steps","formData","JSON","parse","map","step","removeItem","e","console","savedData","_data$steps","data","autoSaveInterval","setInterval","length","stringify","log","clearInterval","handleAddIngredient","handleRemoveIngredient","index","newIngredients","splice","handleAddStep","handleRemoveStep","newSteps","handleIngredientChange","field","value","handleStepChange","handleStepImageChange","file","target","files","size","type","startsWith","reader","FileReader","onloadend","result","readAsDataURL","handleStepVideoChange","handleImageChange","substring","checkAuthStatus","_data$data","response","ok","json","handlePublishRecipe","_data$data2","setTimeout","FormData","append","forEach","fetch","method","headers","body","contentType","get","includes","text","Error","status","message","recipeId","id","handleSaveDraft","stepsData","handleSubmit","preventDefault","recipeData","errorData","err","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","encType","htmlFor","onChange","placeholder","required","accept","src","alt","min","ingredient","onClick","rows","style","display","disabled","_c","$RefreshReg$"],"sources":["C:/Users/Lenovo/Documents/web_SE/recipe-sharing-app/src/pages/CreateRecipePage.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport './CreateRecipePage.css';\nimport { getAuthToken, getAuthHeaders, apiRequest } from '../utils/apiUtils';\n\nconst CreateRecipePage = () => {\n    const navigate = useNavigate();\n    const [title, setTitle] = useState('');\n    const [image, setImage] = useState(null);\n    const [imagePreview, setImagePreview] = useState(null);\n    const [cookingTime, setCookingTime] = useState('');\n    const [thoughts, setThoughts] = useState('');\n    const [ingredients, setIngredients] = useState([{ name: '', quantity: '', unit: '' }]);\n    const [steps, setSteps] = useState([{ description: '', image: null, video: null, imagePreview: null }]);\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState(null);\n    const [success, setSuccess] = useState(false);\n    const [isSubmitting, setIsSubmitting] = useState(false);\n    const [submitting, setSubmitting] = useState(false);\n    \n    useEffect(() => {\n        // Kiểm tra đăng nhập trước khi làm gì khác\n        const token = getAuthToken();\n        if (!token) {\n            alert(\"Bạn cần đăng nhập để tạo công thức mới\");\n            // Lưu đường dẫn hiện tại để quay lại sau khi đăng nhập\n            localStorage.setItem('redirectAfterLogin', '/create-recipe');\n            // Chuyển hướng đến trang đăng nhập\n            navigate('/login');\n            return;\n        }\n        \n        // Nếu có dữ liệu đã lưu, khôi phục\n        const savedForm = localStorage.getItem('recipeFormData');\n        if (savedForm) {\n            try {\n                const formData = JSON.parse(savedForm);\n                setTitle(formData.title || '');\n                setCookingTime(formData.cookingTime || '');\n                setThoughts(formData.thoughts || '');\n                setIngredients(formData.ingredients || [{ name: '', quantity: '', unit: '' }]);\n                \n                // Khôi phục bước mà không khôi phục hình ảnh/video\n                // Vì localStorage không thể lưu file\n                setSteps(formData.steps?.map(step => ({\n                    ...step,\n                    image: null,\n                    video: null,\n                    imagePreview: null\n                })) || [{ description: '', image: null, video: null, imagePreview: null }]);\n                \n                // Đã khôi phục xong, xóa data\n                localStorage.removeItem('recipeFormData');\n                alert(\"Đã khôi phục dữ liệu công thức bạn đang soạn thảo!\");\n            } catch (e) {\n                console.error(\"Error restoring form:\", e);\n            }\n        }\n    }, [navigate]);\n    \n    useEffect(() => {\n        // Kiểm tra xem có dữ liệu đã lưu không\n        const savedData = localStorage.getItem('pendingRecipeData');\n        if (savedData) {\n            try {\n                const data = JSON.parse(savedData);\n                setTitle(data.title || '');\n                setCookingTime(data.cookingTime || '');\n                setThoughts(data.thoughts || '');\n                setIngredients(data.ingredients || [{ name: '', quantity: '', unit: '' }]);\n                \n                // Khôi phục bước mà không khôi phục hình ảnh/video\n                setSteps(data.steps?.map(step => ({\n                    ...step,\n                    image: null,\n                    video: null,\n                    imagePreview: null\n                })) || [{ description: '', image: null, video: null, imagePreview: null }]);\n                \n                // Đã khôi phục xong, xóa data\n                localStorage.removeItem('pendingRecipeData');\n                alert('Đã khôi phục công thức bạn đang soạn trước đó!');\n            } catch (e) {\n                console.error('Error restoring recipe data:', e);\n            }\n        }\n    }, []);\n    \n    // Tự động lưu form data mỗi 30 giây\n    useEffect(() => {\n        const autoSaveInterval = setInterval(() => {\n            if (title || cookingTime || ingredients.length > 1 || steps.length > 1) {\n                const formData = {\n                    title,\n                    cookingTime,\n                    thoughts,\n                    ingredients,\n                    // Lưu mô tả của bước nhưng không lưu file\n                    steps: steps.map(step => ({ description: step.description }))\n                };\n                localStorage.setItem('pendingRecipeData', JSON.stringify(formData));\n                console.log('Form data auto-saved');\n            }\n        }, 30000);\n        \n        return () => clearInterval(autoSaveInterval);\n    }, [title, cookingTime, thoughts, ingredients, steps]);\n    \n    // Xử lý thêm nguyên liệu\n    const handleAddIngredient = () => {\n        setIngredients([...ingredients, { name: '', quantity: '', unit: '' }]);\n    };\n    \n    // Xử lý xóa nguyên liệu\n    const handleRemoveIngredient = (index) => {\n        if (ingredients.length > 1) {\n            const newIngredients = [...ingredients];\n            newIngredients.splice(index, 1);\n            setIngredients(newIngredients);\n        }\n    };\n    \n    // Xử lý thêm bước\n    const handleAddStep = () => {\n        setSteps([...steps, { description: '', image: null, video: null, imagePreview: null }]);\n    };\n    \n    // Xử lý xóa bước\n    const handleRemoveStep = (index) => {\n        if (steps.length > 1) {\n            const newSteps = [...steps];\n            newSteps.splice(index, 1);\n            setSteps(newSteps);\n        }\n    };\n    \n    // Xử lý thay đổi nguyên liệu\n    const handleIngredientChange = (index, field, value) => {\n        const newIngredients = [...ingredients];\n        newIngredients[index][field] = value;\n        setIngredients(newIngredients);\n    };\n    \n    // Xử lý thay đổi bước\n    const handleStepChange = (index, value) => {\n        const newSteps = [...steps];\n        newSteps[index].description = value;\n        setSteps(newSteps);\n    };\n    \n    // Xử lý thay đổi hình ảnh cho bước\n    const handleStepImageChange = (index, e) => {\n        const file = e.target.files[0];\n        if (!file) return;\n        \n        // Kiểm tra kích thước file (giới hạn 5MB)\n        if (file.size > 5 * 1024 * 1024) {\n            alert('Kích thước file quá lớn. Vui lòng chọn file nhỏ hơn 5MB.');\n            return;\n        }\n        \n        // Kiểm tra loại file\n        if (!file.type.startsWith('image/')) {\n            alert('Vui lòng chọn file hình ảnh.');\n            return;\n        }\n        \n        const newSteps = [...steps];\n        newSteps[index].image = file;\n        \n        // Tạo preview của hình ảnh\n        const reader = new FileReader();\n        reader.onloadend = () => {\n            newSteps[index].imagePreview = reader.result;\n            setSteps(newSteps);\n        };\n        reader.readAsDataURL(file);\n    };\n    \n    // Xử lý thay đổi video cho bước\n    const handleStepVideoChange = (index, e) => {\n        const file = e.target.files[0];\n        if (!file) return;\n        \n        // Kiểm tra kích thước file (giới hạn 50MB cho video)\n        if (file.size > 50 * 1024 * 1024) {\n            alert('Kích thước video quá lớn. Vui lòng chọn file nhỏ hơn 50MB.');\n            return;\n        }\n        \n        // Kiểm tra loại file\n        if (!file.type.startsWith('video/')) {\n            alert('Vui lòng chọn file video.');\n            return;\n        }\n        \n        const newSteps = [...steps];\n        newSteps[index].video = file;\n        setSteps(newSteps);\n    };\n    \n    // Xử lý thay đổi hình ảnh chính\n    const handleImageChange = (e) => {\n        const file = e.target.files[0];\n        if (!file) return;\n        \n        // Kiểm tra kích thước file (giới hạn 5MB)\n        if (file.size > 5 * 1024 * 1024) {\n            alert('Kích thước file quá lớn. Vui lòng chọn file nhỏ hơn 5MB.');\n            return;\n        }\n        \n        setImage(file);\n        \n        // Tạo preview của hình ảnh\n        const reader = new FileReader();\n        reader.onloadend = () => {\n            setImagePreview(reader.result);\n        };\n        reader.readAsDataURL(file);\n    };\n\n    // Sửa hàm getAuthToken\n    const getAuthToken = () => {\n      // THỐNG NHẤT SỬ DỤNG KEY 'token'\n      const token = localStorage.getItem('token');\n      if (!token) {\n        console.error(\"No auth token found in localStorage\");\n        return null;\n      }\n      \n      console.log(\"Auth token found in localStorage:\", token.substring(0, 10) + \"...\");\n      return token;\n    };\n\n    // Kiểm tra trạng thái đăng nhập\n    useEffect(() => {\n        const checkAuthStatus = async () => {\n            const token = getAuthToken();\n            if (!token) {\n              alert(\"Bạn cần đăng nhập để tạo công thức mới\");\n              localStorage.setItem('redirectAfterLogin', '/create-recipe');\n              navigate('/login');\n              return;\n            }\n        \n            // Kiểm tra token có hợp lệ không thông qua API\n            try {\n              const response = await apiRequest('/api/auth/me');\n        \n              if (!response.ok) {\n                // Token không hợp lệ hoặc hết hạn\n                localStorage.removeItem('token');\n                localStorage.setItem('redirectAfterLogin', '/create-recipe');\n                alert(\"Phiên đăng nhập đã hết hạn. Vui lòng đăng nhập lại.\");\n                navigate('/login');\n                return;\n              }\n        \n              // Token hợp lệ - tiếp tục với trang tạo công thức\n              const data = await response.json();\n              console.log(\"Authenticated as:\", data.data?.name || \"Unknown user\");\n            } catch (error) {\n              console.error(\"Error checking authentication:\", error);\n              // Không chuyển hướng trong trường hợp lỗi mạng\n              setError(\"Không thể kiểm tra trạng thái đăng nhập. Vui lòng kiểm tra kết nối mạng.\");\n            }\n        };\n        \n        checkAuthStatus();\n    }, [navigate]);\n    \n    // Xử lý nút \"Đăng công thức\"\n    const handlePublishRecipe = async () => {\n  try {\n    // Validate dữ liệu đầu vào\n    \n    setIsSubmitting(true);\n    \n    // Lấy token xác thực\n    const token = getAuthToken();\n    if (!token) {\n      setError(\"Bạn cần đăng nhập để đăng công thức. Đang chuyển hướng...\");\n      setIsSubmitting(false);\n      \n      // Lưu đường dẫn hiện tại để quay lại sau khi đăng nhập\n      localStorage.setItem('redirectAfterLogin', '/create-recipe');\n      \n      // Chờ 2 giây trước khi chuyển hướng\n      setTimeout(() => {\n        navigate('/login');\n      }, 2000);\n      return;\n    }\n    \n    const formData = new FormData();\n    \n    // Thêm các trường dữ liệu\n    formData.append('title', title);\n    formData.append('cookingTime', cookingTime);\n    formData.append('thoughts', thoughts);\n    formData.append('status', 'published');\n    \n    // Thêm hình ảnh chính\n    if (image) {\n      formData.append('image', image);\n    }\n    \n    // Thêm các nguyên liệu\n    formData.append('ingredients', JSON.stringify(ingredients));\n    \n    // Thêm các bước\n    formData.append('steps', JSON.stringify(steps.map(step => ({\n      description: step.description\n    }))));\n\n    // Thêm hình ảnh và video cho từng bước\n    steps.forEach((step, index) => {\n      if (step.image) {\n        formData.append(`step_images[${index}]`, step.image);\n      }\n      if (step.video) {\n        formData.append(`step_videos[${index}]`, step.video);\n      }\n    });\n    \n    // Log data để debug\n    console.log(\"Sending with token:\", token.substring(0, 15) + \"...\");\n\n    // Gửi request với token trong header\n    const response = await fetch('http://localhost:5000/api/recipes', {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${token}`\n      },\n      body: formData\n    });\n    \n    // Kiểm tra response có phải là JSON không\n    const contentType = response.headers.get('content-type');\n    let data;\n    \n    if (contentType && contentType.includes('application/json')) {\n      data = await response.json();\n    } else {\n      const text = await response.text();\n      console.error(\"Server returned non-JSON response:\", text);\n      throw new Error(\"Máy chủ trả về dữ liệu không hợp lệ\");\n    }\n    \n    if (!response.ok) {\n      // Kiểm tra lỗi 401\n      if (response.status === 401) {\n        // Token hết hạn hoặc không hợp lệ\n        localStorage.removeItem('token');\n        localStorage.setItem('redirectAfterLogin', '/create-recipe');\n        setError(\"Phiên đăng nhập đã hết hạn. Vui lòng đăng nhập lại.\");\n        setTimeout(() => {\n          navigate('/login');\n        }, 2000);\n        return;\n      }\n      \n      throw new Error(data.message || 'Không thể tạo công thức');\n    }\n    \n    // Xử lý thành công\n    setSuccess(true);\n    \n    // Lấy ID công thức từ response\n    const recipeId = data.data?.id;\n    console.log(\"Created recipe with ID:\", recipeId);\n    \n    if (!recipeId) {\n      console.error(\"Recipe ID not found in response:\", data);\n    }\n    \n    // Chuyển đến trang chi tiết công thức với ID đúng\n    setTimeout(() => {\n      navigate(`/recipe/${recipeId}`);\n    }, 2000);\n    \n  } catch (error) {\n    console.error(\"Error creating recipe:\", error);\n    setError(error.message || \"Đã có lỗi xảy ra khi tạo công thức\");\n  } finally {\n    setIsSubmitting(false);\n  }\n};\n    \n    // Xử lý nút \"Lưu bản nháp\"\n    const handleSaveDraft = async () => {\n        if (!title) {\n            setError('Vui lòng nhập tên món ăn');\n            return;\n        }\n        \n        try {\n            setLoading(true);\n            setError(null);\n            \n            // Lấy token bằng hàm getAuthToken đã chuẩn hóa\n            const token = getAuthToken();\n            if (!token) {\n                setError(\"Bạn cần đăng nhập để lưu bản nháp công thức\");\n                setLoading(false);\n                return;\n            }\n            \n            // Tạo FormData để gửi cả file và dữ liệu\n            const formData = new FormData();\n            formData.append('title', title);\n            formData.append('cookingTime', cookingTime || '0');\n            formData.append('thoughts', thoughts || '');\n            formData.append('status', 'draft'); // Trạng thái bản nháp\n            \n            // Thêm hình ảnh món ăn nếu có\n            if (image) {\n                formData.append('image', image);\n            }\n            \n            // Thêm nguyên liệu dưới dạng JSON (có thể rỗng cho bản nháp)\n            formData.append('ingredients', JSON.stringify(ingredients));\n            \n            // Chuẩn bị steps (không có hình ảnh/video lúc này)\n            const stepsData = steps.map(step => ({ description: step.description || '' }));\n            formData.append('steps', JSON.stringify(stepsData));\n            \n            // Thêm step images và videos riêng biệt\n            steps.forEach((step, index) => {\n                if (step.image) {\n                    formData.append(`step_images[${index}]`, step.image);\n                }\n                if (step.video) {\n                    formData.append(`step_videos[${index}]`, step.video);\n                }\n            });\n            \n            const response = await fetch('http://localhost:5000/api/recipes/draft', {\n                method: 'POST',\n                headers: {\n                    'Authorization': `Bearer ${token}`\n                },\n                body: formData\n            });\n            \n            if (response.ok) {\n                const result = await response.json();\n                \n                // Xóa dữ liệu công thức đã lưu\n                localStorage.removeItem('recipeFormData');\n                localStorage.removeItem('pendingRecipeData');\n                \n                // Hiển thị thông báo thành công\n                alert('Công thức đã được lưu dưới dạng bản nháp');\n                \n                // Chuyển hướng về dashboard\n                navigate('/dashboard');\n            } else {\n                const result = await response.json();\n                throw new Error(result.message || 'Lỗi khi lưu bản nháp');\n            }\n        } catch (error) {\n            setError(`Lỗi: ${error.message}`);\n            console.error(\"Error saving draft:\", error);\n        } finally {\n            setLoading(false);\n        }\n    };\n    \n    // Xử lý nút \"Đăng công thức\" - phiên bản mới\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        \n        try {\n            // Lưu công thức hiện tại vào localStorage trước khi gửi\n            const recipeData = {\n              title, \n              cookingTime,\n              ingredients,\n              steps,\n              thoughts\n            };\n            localStorage.setItem('recipe_draft', JSON.stringify(recipeData));\n            \n            setIsSubmitting(true);\n            \n            // Chuẩn bị dữ liệu gửi lên\n            const formData = new FormData();\n            formData.append('title', title);\n            formData.append('cookingTime', cookingTime);\n            formData.append('thoughts', thoughts);\n            formData.append('status', 'published');\n            \n            // Thêm hình ảnh chính\n            if (image) {\n              formData.append('image', image);\n            }\n            \n            // Thêm các nguyên liệu\n            formData.append('ingredients', JSON.stringify(ingredients));\n            \n            // Thêm các bước\n            formData.append('steps', JSON.stringify(steps.map(step => ({\n              description: step.description\n            }))));\n            \n            // Thêm hình ảnh và video cho từng bước\n            steps.forEach((step, index) => {\n              if (step.image) {\n                formData.append(`step_images[${index}]`, step.image);\n              }\n              if (step.video) {\n                formData.append(`step_videos[${index}]`, step.video);\n              }\n            });\n            \n            // Lấy token đúng\n            const token = localStorage.getItem('auth_token'); // Sử dụng auth_token thống nhất\n            \n            // Kiểm tra token trước khi gửi request\n            if (!token) {\n              setError('Không tìm thấy thông tin xác thực. Vui lòng đăng nhập lại.');\n              localStorage.removeItem('user');\n              navigate('/login');\n              return;\n            }\n            \n            const response = await fetch('http://localhost:5000/api/recipes', {\n              method: 'POST',\n              headers: {\n                'Authorization': `Bearer ${token}`\n              },\n              body: formData\n            });\n            \n            if (response.ok) {\n              const data = await response.json();\n              alert('Công thức đã được tạo thành công!');\n              navigate(`/recipe/${data.id}`);\n            } else {\n              // Xử lý khi server trả về lỗi\n              const errorData = await response.json();\n              \n              // Nếu token không hợp lệ, chuyển về trang đăng nhập\n              if (response.status === 401) {\n                setError('Phiên đăng nhập đã hết hạn. Vui lòng đăng nhập lại.');\n                localStorage.removeItem('auth_token');\n                localStorage.removeItem('user');\n                setTimeout(() => navigate('/login'), 2000);\n                return;\n              }\n              \n              setError(errorData.message || 'Có lỗi xảy ra khi tạo công thức.');\n            }\n        } catch (err) {\n            console.error('Error creating recipe:', err);\n            setError('Lỗi kết nối đến server. Vui lòng thử lại sau.');\n        } finally {\n            setIsSubmitting(false);\n        }\n    };\n    \n    return (\n        <div className=\"create-recipe-page\">\n            <h1>Tạo công thức mới</h1>\n            \n            {error && (\n  <div className=\"error-message\">\n    <i className=\"fas fa-exclamation-circle\"></i>\n    {error}\n  </div>\n)}\n\n{submitting && (\n  <div className=\"overlay\">\n    <div className=\"loading-spinner\">\n      <div className=\"spinner\"></div>\n      <p>Đang tạo công thức...</p>\n    </div>\n  </div>\n)}\n\n            {success && <div className=\"success-message\">Công thức đã được đăng thành công!</div>}\n            \n            <form onSubmit={handleSubmit} className=\"recipe-form\" encType=\"multipart/form-data\">\n                {/* Tên món ăn */}\n                <div className=\"form-group\">\n                    <label htmlFor=\"title\">Tên món ăn *</label>\n                    <input \n                        type=\"text\" \n                        id=\"title\"\n                        value={title}\n                        onChange={(e) => setTitle(e.target.value)}\n                        placeholder=\"Nhập tên món ăn\"\n                        required\n                    />\n                </div>\n                \n                {/* Hình ảnh */}\n                <div className=\"form-group\">\n                    <label htmlFor=\"image\">Hình ảnh món ăn</label>\n                    <input \n                        type=\"file\" \n                        id=\"image\"\n                        accept=\"image/*\"\n                        onChange={handleImageChange}\n                    />\n                    {imagePreview && (\n                        <div className=\"image-preview\">\n                            <img src={imagePreview} alt=\"Xem trước\" />\n                        </div>\n                    )}\n                </div>\n                \n                {/* Thời gian nấu */}\n                <div className=\"form-group\">\n                    <label htmlFor=\"cookingTime\">Thời gian nấu (phút) *</label>\n                    <input \n                        type=\"number\" \n                        id=\"cookingTime\"\n                        value={cookingTime}\n                        onChange={(e) => setCookingTime(e.target.value)}\n                        min=\"1\"\n                        placeholder=\"Nhập thời gian nấu\"\n                        required\n                    />\n                </div>\n                \n                {/* Nguyên liệu */}\n                <div className=\"form-group\">\n                    <h3>Nguyên liệu *</h3>\n                    {ingredients.map((ingredient, index) => (\n                        <div key={index} className=\"ingredient-row\">\n                            <input\n                                type=\"text\"\n                                placeholder=\"Tên nguyên liệu\"\n                                value={ingredient.name}\n                                onChange={(e) => handleIngredientChange(index, 'name', e.target.value)}\n                                required\n                            />\n                            <input\n                                type=\"text\"\n                                placeholder=\"Số lượng\"\n                                value={ingredient.quantity}\n                                onChange={(e) => handleIngredientChange(index, 'quantity', e.target.value)}\n                                required\n                            />\n                            <input\n                                type=\"text\"\n                                placeholder=\"Đơn vị (g, ml...)\"\n                                value={ingredient.unit}\n                                onChange={(e) => handleIngredientChange(index, 'unit', e.target.value)}\n                            />\n                            {ingredients.length > 1 && (\n                                <button \n                                    type=\"button\" \n                                    className=\"btn-remove\" \n                                    onClick={() => handleRemoveIngredient(index)}\n                                >\n                                    <i className=\"fas fa-times\"></i>\n                                </button>\n                            )}\n                        </div>\n                    ))}\n                    <button type=\"button\" className=\"btn-add\" onClick={handleAddIngredient}>\n                        <i className=\"fas fa-plus\"></i> Thêm nguyên liệu\n                    </button>\n                </div>\n                \n                {/* Các bước nấu */}\n                <div className=\"form-group\">\n                    <h3>Các bước *</h3>\n                    {steps.map((step, index) => (\n                        <div key={index} className=\"step-row\">\n                            <div className=\"step-header\">\n                                <span className=\"step-number\">Bước {index + 1}</span>\n                                {steps.length > 1 && (\n                                    <button \n                                        type=\"button\" \n                                        className=\"btn-remove\" \n                                        onClick={() => handleRemoveStep(index)}\n                                    >\n                                        <i className=\"fas fa-times\"></i>\n                                    </button>\n                                )}\n                            </div>\n                            <textarea\n                                placeholder={`Mô tả chi tiết cho bước ${index + 1}`}\n                                value={step.description || ''} \n                                onChange={(e) => handleStepChange(index, e.target.value)}\n                                required\n                                rows=\"3\"\n                            />\n                            <div className=\"step-media\">\n                                <div className=\"media-input\">\n                                    <label>\n                                        <i className=\"fas fa-image\"></i> Thêm hình ảnh\n                                        <input \n                                            type=\"file\" \n                                            accept=\"image/*\"\n                                            onChange={(e) => handleStepImageChange(index, e)}\n                                            style={{display: 'none'}}\n                                        />\n                                    </label>\n                                    <label>\n                                        <i className=\"fas fa-video\"></i> Thêm video\n                                        <input \n                                            type=\"file\" \n                                            accept=\"video/*\"\n                                            onChange={(e) => handleStepVideoChange(index, e)}\n                                            style={{display: 'none'}}\n                                        />\n                                    </label>\n                                </div>\n                                \n                                {step.imagePreview && (\n                                    <div className=\"media-preview\">\n                                        <img src={step.imagePreview} alt={`Bước ${index + 1}`} />\n                                        <button \n                                            type=\"button\" \n                                            className=\"btn-remove-media\" \n                                            onClick={() => {\n                                                const newSteps = [...steps];\n                                                newSteps[index].image = null;\n                                                newSteps[index].imagePreview = null;\n                                                setSteps(newSteps);\n                                            }}\n                                        >\n                                            <i className=\"fas fa-times\"></i>\n                                        </button>\n                                    </div>\n                                )}\n                                \n                                {step.video && (\n                                    <div className=\"media-preview\">\n                                        <div className=\"video-info\">\n                                            <i className=\"fas fa-film\"></i>\n                                            <span>{step.video.name}</span>\n                                            <button \n                                                type=\"button\" \n                                                className=\"btn-remove-media\" \n                                                onClick={() => {\n                                                    const newSteps = [...steps];\n                                                    newSteps[index].video = null;\n                                                    setSteps(newSteps);\n                                                }}\n                                            >\n                                                <i className=\"fas fa-times\"></i>\n                                            </button>\n                                        </div>\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n                    ))}\n                    <button type=\"button\" className=\"btn-add\" onClick={handleAddStep}>\n                        <i className=\"fas fa-plus\"></i> Thêm bước\n                    </button>\n                </div>\n                \n                {/* Suy nghĩ và cảm nhận */}\n                <div className=\"form-group\">\n                    <label htmlFor=\"thoughts\">Suy nghĩ và cảm nhận về món ăn</label>\n                    <textarea \n                        id=\"thoughts\"\n                        value={thoughts || ''} \n                        onChange={(e) => setThoughts(e.target.value)}\n                        placeholder=\"Chia sẻ câu chuyện, cảm nhận của bạn về món ăn này...\"\n                        rows={4} \n                    /> \n                </div>\n                \n                {/* Nút hành động */}\n                <div className=\"form-actions\">\n                    <button \n                        type=\"button\"\n                        className=\"secondary-button\"\n                        disabled={loading}\n                        onClick={handleSaveDraft}\n                    >\n                        <i className=\"fas fa-save\"></i> Lưu bản nháp\n                    </button>\n                    \n                    <button \n                        type=\"submit\"\n                        className=\"primary-button\"\n                        disabled={loading || isSubmitting}\n                    >\n                        <i className=\"fas fa-paper-plane\"></i> {loading ? 'Đang xử lý...' : 'Đăng công thức'}\n                    </button>\n                </div>\n            </form>\n        </div>\n    );\n};\n\nexport default CreateRecipePage;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,OAAO,wBAAwB;AAC/B,SAASC,YAAY,EAAEC,cAAc,EAAEC,UAAU,QAAQ,mBAAmB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE7E,MAAMC,gBAAgB,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC3B,MAAMC,QAAQ,GAAGR,WAAW,CAAC,CAAC;EAC9B,MAAM,CAACS,KAAK,EAAEC,QAAQ,CAAC,GAAGZ,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAACa,KAAK,EAAEC,QAAQ,CAAC,GAAGd,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAM,CAACe,YAAY,EAAEC,eAAe,CAAC,GAAGhB,QAAQ,CAAC,IAAI,CAAC;EACtD,MAAM,CAACiB,WAAW,EAAEC,cAAc,CAAC,GAAGlB,QAAQ,CAAC,EAAE,CAAC;EAClD,MAAM,CAACmB,QAAQ,EAAEC,WAAW,CAAC,GAAGpB,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACqB,WAAW,EAAEC,cAAc,CAAC,GAAGtB,QAAQ,CAAC,CAAC;IAAEuB,IAAI,EAAE,EAAE;IAAEC,QAAQ,EAAE,EAAE;IAAEC,IAAI,EAAE;EAAG,CAAC,CAAC,CAAC;EACtF,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAG3B,QAAQ,CAAC,CAAC;IAAE4B,WAAW,EAAE,EAAE;IAAEf,KAAK,EAAE,IAAI;IAAEgB,KAAK,EAAE,IAAI;IAAEd,YAAY,EAAE;EAAK,CAAC,CAAC,CAAC;EACvG,MAAM,CAACe,OAAO,EAAEC,UAAU,CAAC,GAAG/B,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAACgC,KAAK,EAAEC,QAAQ,CAAC,GAAGjC,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAM,CAACkC,OAAO,EAAEC,UAAU,CAAC,GAAGnC,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAACoC,YAAY,EAAEC,eAAe,CAAC,GAAGrC,QAAQ,CAAC,KAAK,CAAC;EACvD,MAAM,CAACsC,UAAU,EAAEC,aAAa,CAAC,GAAGvC,QAAQ,CAAC,KAAK,CAAC;EAEnDC,SAAS,CAAC,MAAM;IACZ;IACA,MAAMuC,KAAK,GAAGrC,YAAY,CAAC,CAAC;IAC5B,IAAI,CAACqC,KAAK,EAAE;MACRC,KAAK,CAAC,wCAAwC,CAAC;MAC/C;MACAC,YAAY,CAACC,OAAO,CAAC,oBAAoB,EAAE,gBAAgB,CAAC;MAC5D;MACAjC,QAAQ,CAAC,QAAQ,CAAC;MAClB;IACJ;;IAEA;IACA,MAAMkC,SAAS,GAAGF,YAAY,CAACG,OAAO,CAAC,gBAAgB,CAAC;IACxD,IAAID,SAAS,EAAE;MACX,IAAI;QAAA,IAAAE,eAAA;QACA,MAAMC,QAAQ,GAAGC,IAAI,CAACC,KAAK,CAACL,SAAS,CAAC;QACtChC,QAAQ,CAACmC,QAAQ,CAACpC,KAAK,IAAI,EAAE,CAAC;QAC9BO,cAAc,CAAC6B,QAAQ,CAAC9B,WAAW,IAAI,EAAE,CAAC;QAC1CG,WAAW,CAAC2B,QAAQ,CAAC5B,QAAQ,IAAI,EAAE,CAAC;QACpCG,cAAc,CAACyB,QAAQ,CAAC1B,WAAW,IAAI,CAAC;UAAEE,IAAI,EAAE,EAAE;UAAEC,QAAQ,EAAE,EAAE;UAAEC,IAAI,EAAE;QAAG,CAAC,CAAC,CAAC;;QAE9E;QACA;QACAE,QAAQ,CAAC,EAAAmB,eAAA,GAAAC,QAAQ,CAACrB,KAAK,cAAAoB,eAAA,uBAAdA,eAAA,CAAgBI,GAAG,CAACC,IAAI,KAAK;UAClC,GAAGA,IAAI;UACPtC,KAAK,EAAE,IAAI;UACXgB,KAAK,EAAE,IAAI;UACXd,YAAY,EAAE;QAClB,CAAC,CAAC,CAAC,KAAI,CAAC;UAAEa,WAAW,EAAE,EAAE;UAAEf,KAAK,EAAE,IAAI;UAAEgB,KAAK,EAAE,IAAI;UAAEd,YAAY,EAAE;QAAK,CAAC,CAAC,CAAC;;QAE3E;QACA2B,YAAY,CAACU,UAAU,CAAC,gBAAgB,CAAC;QACzCX,KAAK,CAAC,oDAAoD,CAAC;MAC/D,CAAC,CAAC,OAAOY,CAAC,EAAE;QACRC,OAAO,CAACtB,KAAK,CAAC,uBAAuB,EAAEqB,CAAC,CAAC;MAC7C;IACJ;EACJ,CAAC,EAAE,CAAC3C,QAAQ,CAAC,CAAC;EAEdT,SAAS,CAAC,MAAM;IACZ;IACA,MAAMsD,SAAS,GAAGb,YAAY,CAACG,OAAO,CAAC,mBAAmB,CAAC;IAC3D,IAAIU,SAAS,EAAE;MACX,IAAI;QAAA,IAAAC,WAAA;QACA,MAAMC,IAAI,GAAGT,IAAI,CAACC,KAAK,CAACM,SAAS,CAAC;QAClC3C,QAAQ,CAAC6C,IAAI,CAAC9C,KAAK,IAAI,EAAE,CAAC;QAC1BO,cAAc,CAACuC,IAAI,CAACxC,WAAW,IAAI,EAAE,CAAC;QACtCG,WAAW,CAACqC,IAAI,CAACtC,QAAQ,IAAI,EAAE,CAAC;QAChCG,cAAc,CAACmC,IAAI,CAACpC,WAAW,IAAI,CAAC;UAAEE,IAAI,EAAE,EAAE;UAAEC,QAAQ,EAAE,EAAE;UAAEC,IAAI,EAAE;QAAG,CAAC,CAAC,CAAC;;QAE1E;QACAE,QAAQ,CAAC,EAAA6B,WAAA,GAAAC,IAAI,CAAC/B,KAAK,cAAA8B,WAAA,uBAAVA,WAAA,CAAYN,GAAG,CAACC,IAAI,KAAK;UAC9B,GAAGA,IAAI;UACPtC,KAAK,EAAE,IAAI;UACXgB,KAAK,EAAE,IAAI;UACXd,YAAY,EAAE;QAClB,CAAC,CAAC,CAAC,KAAI,CAAC;UAAEa,WAAW,EAAE,EAAE;UAAEf,KAAK,EAAE,IAAI;UAAEgB,KAAK,EAAE,IAAI;UAAEd,YAAY,EAAE;QAAK,CAAC,CAAC,CAAC;;QAE3E;QACA2B,YAAY,CAACU,UAAU,CAAC,mBAAmB,CAAC;QAC5CX,KAAK,CAAC,gDAAgD,CAAC;MAC3D,CAAC,CAAC,OAAOY,CAAC,EAAE;QACRC,OAAO,CAACtB,KAAK,CAAC,8BAA8B,EAAEqB,CAAC,CAAC;MACpD;IACJ;EACJ,CAAC,EAAE,EAAE,CAAC;;EAEN;EACApD,SAAS,CAAC,MAAM;IACZ,MAAMyD,gBAAgB,GAAGC,WAAW,CAAC,MAAM;MACvC,IAAIhD,KAAK,IAAIM,WAAW,IAAII,WAAW,CAACuC,MAAM,GAAG,CAAC,IAAIlC,KAAK,CAACkC,MAAM,GAAG,CAAC,EAAE;QACpE,MAAMb,QAAQ,GAAG;UACbpC,KAAK;UACLM,WAAW;UACXE,QAAQ;UACRE,WAAW;UACX;UACAK,KAAK,EAAEA,KAAK,CAACwB,GAAG,CAACC,IAAI,KAAK;YAAEvB,WAAW,EAAEuB,IAAI,CAACvB;UAAY,CAAC,CAAC;QAChE,CAAC;QACDc,YAAY,CAACC,OAAO,CAAC,mBAAmB,EAAEK,IAAI,CAACa,SAAS,CAACd,QAAQ,CAAC,CAAC;QACnEO,OAAO,CAACQ,GAAG,CAAC,sBAAsB,CAAC;MACvC;IACJ,CAAC,EAAE,KAAK,CAAC;IAET,OAAO,MAAMC,aAAa,CAACL,gBAAgB,CAAC;EAChD,CAAC,EAAE,CAAC/C,KAAK,EAAEM,WAAW,EAAEE,QAAQ,EAAEE,WAAW,EAAEK,KAAK,CAAC,CAAC;;EAEtD;EACA,MAAMsC,mBAAmB,GAAGA,CAAA,KAAM;IAC9B1C,cAAc,CAAC,CAAC,GAAGD,WAAW,EAAE;MAAEE,IAAI,EAAE,EAAE;MAAEC,QAAQ,EAAE,EAAE;MAAEC,IAAI,EAAE;IAAG,CAAC,CAAC,CAAC;EAC1E,CAAC;;EAED;EACA,MAAMwC,sBAAsB,GAAIC,KAAK,IAAK;IACtC,IAAI7C,WAAW,CAACuC,MAAM,GAAG,CAAC,EAAE;MACxB,MAAMO,cAAc,GAAG,CAAC,GAAG9C,WAAW,CAAC;MACvC8C,cAAc,CAACC,MAAM,CAACF,KAAK,EAAE,CAAC,CAAC;MAC/B5C,cAAc,CAAC6C,cAAc,CAAC;IAClC;EACJ,CAAC;;EAED;EACA,MAAME,aAAa,GAAGA,CAAA,KAAM;IACxB1C,QAAQ,CAAC,CAAC,GAAGD,KAAK,EAAE;MAAEE,WAAW,EAAE,EAAE;MAAEf,KAAK,EAAE,IAAI;MAAEgB,KAAK,EAAE,IAAI;MAAEd,YAAY,EAAE;IAAK,CAAC,CAAC,CAAC;EAC3F,CAAC;;EAED;EACA,MAAMuD,gBAAgB,GAAIJ,KAAK,IAAK;IAChC,IAAIxC,KAAK,CAACkC,MAAM,GAAG,CAAC,EAAE;MAClB,MAAMW,QAAQ,GAAG,CAAC,GAAG7C,KAAK,CAAC;MAC3B6C,QAAQ,CAACH,MAAM,CAACF,KAAK,EAAE,CAAC,CAAC;MACzBvC,QAAQ,CAAC4C,QAAQ,CAAC;IACtB;EACJ,CAAC;;EAED;EACA,MAAMC,sBAAsB,GAAGA,CAACN,KAAK,EAAEO,KAAK,EAAEC,KAAK,KAAK;IACpD,MAAMP,cAAc,GAAG,CAAC,GAAG9C,WAAW,CAAC;IACvC8C,cAAc,CAACD,KAAK,CAAC,CAACO,KAAK,CAAC,GAAGC,KAAK;IACpCpD,cAAc,CAAC6C,cAAc,CAAC;EAClC,CAAC;;EAED;EACA,MAAMQ,gBAAgB,GAAGA,CAACT,KAAK,EAAEQ,KAAK,KAAK;IACvC,MAAMH,QAAQ,GAAG,CAAC,GAAG7C,KAAK,CAAC;IAC3B6C,QAAQ,CAACL,KAAK,CAAC,CAACtC,WAAW,GAAG8C,KAAK;IACnC/C,QAAQ,CAAC4C,QAAQ,CAAC;EACtB,CAAC;;EAED;EACA,MAAMK,qBAAqB,GAAGA,CAACV,KAAK,EAAEb,CAAC,KAAK;IACxC,MAAMwB,IAAI,GAAGxB,CAAC,CAACyB,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC;IAC9B,IAAI,CAACF,IAAI,EAAE;;IAEX;IACA,IAAIA,IAAI,CAACG,IAAI,GAAG,CAAC,GAAG,IAAI,GAAG,IAAI,EAAE;MAC7BvC,KAAK,CAAC,0DAA0D,CAAC;MACjE;IACJ;;IAEA;IACA,IAAI,CAACoC,IAAI,CAACI,IAAI,CAACC,UAAU,CAAC,QAAQ,CAAC,EAAE;MACjCzC,KAAK,CAAC,8BAA8B,CAAC;MACrC;IACJ;IAEA,MAAM8B,QAAQ,GAAG,CAAC,GAAG7C,KAAK,CAAC;IAC3B6C,QAAQ,CAACL,KAAK,CAAC,CAACrD,KAAK,GAAGgE,IAAI;;IAE5B;IACA,MAAMM,MAAM,GAAG,IAAIC,UAAU,CAAC,CAAC;IAC/BD,MAAM,CAACE,SAAS,GAAG,MAAM;MACrBd,QAAQ,CAACL,KAAK,CAAC,CAACnD,YAAY,GAAGoE,MAAM,CAACG,MAAM;MAC5C3D,QAAQ,CAAC4C,QAAQ,CAAC;IACtB,CAAC;IACDY,MAAM,CAACI,aAAa,CAACV,IAAI,CAAC;EAC9B,CAAC;;EAED;EACA,MAAMW,qBAAqB,GAAGA,CAACtB,KAAK,EAAEb,CAAC,KAAK;IACxC,MAAMwB,IAAI,GAAGxB,CAAC,CAACyB,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC;IAC9B,IAAI,CAACF,IAAI,EAAE;;IAEX;IACA,IAAIA,IAAI,CAACG,IAAI,GAAG,EAAE,GAAG,IAAI,GAAG,IAAI,EAAE;MAC9BvC,KAAK,CAAC,4DAA4D,CAAC;MACnE;IACJ;;IAEA;IACA,IAAI,CAACoC,IAAI,CAACI,IAAI,CAACC,UAAU,CAAC,QAAQ,CAAC,EAAE;MACjCzC,KAAK,CAAC,2BAA2B,CAAC;MAClC;IACJ;IAEA,MAAM8B,QAAQ,GAAG,CAAC,GAAG7C,KAAK,CAAC;IAC3B6C,QAAQ,CAACL,KAAK,CAAC,CAACrC,KAAK,GAAGgD,IAAI;IAC5BlD,QAAQ,CAAC4C,QAAQ,CAAC;EACtB,CAAC;;EAED;EACA,MAAMkB,iBAAiB,GAAIpC,CAAC,IAAK;IAC7B,MAAMwB,IAAI,GAAGxB,CAAC,CAACyB,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC;IAC9B,IAAI,CAACF,IAAI,EAAE;;IAEX;IACA,IAAIA,IAAI,CAACG,IAAI,GAAG,CAAC,GAAG,IAAI,GAAG,IAAI,EAAE;MAC7BvC,KAAK,CAAC,0DAA0D,CAAC;MACjE;IACJ;IAEA3B,QAAQ,CAAC+D,IAAI,CAAC;;IAEd;IACA,MAAMM,MAAM,GAAG,IAAIC,UAAU,CAAC,CAAC;IAC/BD,MAAM,CAACE,SAAS,GAAG,MAAM;MACrBrE,eAAe,CAACmE,MAAM,CAACG,MAAM,CAAC;IAClC,CAAC;IACDH,MAAM,CAACI,aAAa,CAACV,IAAI,CAAC;EAC9B,CAAC;;EAED;EACA,MAAM1E,YAAY,GAAGA,CAAA,KAAM;IACzB;IACA,MAAMqC,KAAK,GAAGE,YAAY,CAACG,OAAO,CAAC,OAAO,CAAC;IAC3C,IAAI,CAACL,KAAK,EAAE;MACVc,OAAO,CAACtB,KAAK,CAAC,qCAAqC,CAAC;MACpD,OAAO,IAAI;IACb;IAEAsB,OAAO,CAACQ,GAAG,CAAC,mCAAmC,EAAEtB,KAAK,CAACkD,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,KAAK,CAAC;IAChF,OAAOlD,KAAK;EACd,CAAC;;EAED;EACAvC,SAAS,CAAC,MAAM;IACZ,MAAM0F,eAAe,GAAG,MAAAA,CAAA,KAAY;MAChC,MAAMnD,KAAK,GAAGrC,YAAY,CAAC,CAAC;MAC5B,IAAI,CAACqC,KAAK,EAAE;QACVC,KAAK,CAAC,wCAAwC,CAAC;QAC/CC,YAAY,CAACC,OAAO,CAAC,oBAAoB,EAAE,gBAAgB,CAAC;QAC5DjC,QAAQ,CAAC,QAAQ,CAAC;QAClB;MACF;;MAEA;MACA,IAAI;QAAA,IAAAkF,UAAA;QACF,MAAMC,QAAQ,GAAG,MAAMxF,UAAU,CAAC,cAAc,CAAC;QAEjD,IAAI,CAACwF,QAAQ,CAACC,EAAE,EAAE;UAChB;UACApD,YAAY,CAACU,UAAU,CAAC,OAAO,CAAC;UAChCV,YAAY,CAACC,OAAO,CAAC,oBAAoB,EAAE,gBAAgB,CAAC;UAC5DF,KAAK,CAAC,qDAAqD,CAAC;UAC5D/B,QAAQ,CAAC,QAAQ,CAAC;UAClB;QACF;;QAEA;QACA,MAAM+C,IAAI,GAAG,MAAMoC,QAAQ,CAACE,IAAI,CAAC,CAAC;QAClCzC,OAAO,CAACQ,GAAG,CAAC,mBAAmB,EAAE,EAAA8B,UAAA,GAAAnC,IAAI,CAACA,IAAI,cAAAmC,UAAA,uBAATA,UAAA,CAAWrE,IAAI,KAAI,cAAc,CAAC;MACrE,CAAC,CAAC,OAAOS,KAAK,EAAE;QACdsB,OAAO,CAACtB,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;QACtD;QACAC,QAAQ,CAAC,0EAA0E,CAAC;MACtF;IACJ,CAAC;IAED0D,eAAe,CAAC,CAAC;EACrB,CAAC,EAAE,CAACjF,QAAQ,CAAC,CAAC;;EAEd;EACA,MAAMsF,mBAAmB,GAAG,MAAAA,CAAA,KAAY;IAC1C,IAAI;MAAA,IAAAC,WAAA;MACF;;MAEA5D,eAAe,CAAC,IAAI,CAAC;;MAErB;MACA,MAAMG,KAAK,GAAGrC,YAAY,CAAC,CAAC;MAC5B,IAAI,CAACqC,KAAK,EAAE;QACVP,QAAQ,CAAC,2DAA2D,CAAC;QACrEI,eAAe,CAAC,KAAK,CAAC;;QAEtB;QACAK,YAAY,CAACC,OAAO,CAAC,oBAAoB,EAAE,gBAAgB,CAAC;;QAE5D;QACAuD,UAAU,CAAC,MAAM;UACfxF,QAAQ,CAAC,QAAQ,CAAC;QACpB,CAAC,EAAE,IAAI,CAAC;QACR;MACF;MAEA,MAAMqC,QAAQ,GAAG,IAAIoD,QAAQ,CAAC,CAAC;;MAE/B;MACApD,QAAQ,CAACqD,MAAM,CAAC,OAAO,EAAEzF,KAAK,CAAC;MAC/BoC,QAAQ,CAACqD,MAAM,CAAC,aAAa,EAAEnF,WAAW,CAAC;MAC3C8B,QAAQ,CAACqD,MAAM,CAAC,UAAU,EAAEjF,QAAQ,CAAC;MACrC4B,QAAQ,CAACqD,MAAM,CAAC,QAAQ,EAAE,WAAW,CAAC;;MAEtC;MACA,IAAIvF,KAAK,EAAE;QACTkC,QAAQ,CAACqD,MAAM,CAAC,OAAO,EAAEvF,KAAK,CAAC;MACjC;;MAEA;MACAkC,QAAQ,CAACqD,MAAM,CAAC,aAAa,EAAEpD,IAAI,CAACa,SAAS,CAACxC,WAAW,CAAC,CAAC;;MAE3D;MACA0B,QAAQ,CAACqD,MAAM,CAAC,OAAO,EAAEpD,IAAI,CAACa,SAAS,CAACnC,KAAK,CAACwB,GAAG,CAACC,IAAI,KAAK;QACzDvB,WAAW,EAAEuB,IAAI,CAACvB;MACpB,CAAC,CAAC,CAAC,CAAC,CAAC;;MAEL;MACAF,KAAK,CAAC2E,OAAO,CAAC,CAAClD,IAAI,EAAEe,KAAK,KAAK;QAC7B,IAAIf,IAAI,CAACtC,KAAK,EAAE;UACdkC,QAAQ,CAACqD,MAAM,CAAC,eAAelC,KAAK,GAAG,EAAEf,IAAI,CAACtC,KAAK,CAAC;QACtD;QACA,IAAIsC,IAAI,CAACtB,KAAK,EAAE;UACdkB,QAAQ,CAACqD,MAAM,CAAC,eAAelC,KAAK,GAAG,EAAEf,IAAI,CAACtB,KAAK,CAAC;QACtD;MACF,CAAC,CAAC;;MAEF;MACAyB,OAAO,CAACQ,GAAG,CAAC,qBAAqB,EAAEtB,KAAK,CAACkD,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,KAAK,CAAC;;MAElE;MACA,MAAMG,QAAQ,GAAG,MAAMS,KAAK,CAAC,mCAAmC,EAAE;QAChEC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACP,eAAe,EAAE,UAAUhE,KAAK;QAClC,CAAC;QACDiE,IAAI,EAAE1D;MACR,CAAC,CAAC;;MAEF;MACA,MAAM2D,WAAW,GAAGb,QAAQ,CAACW,OAAO,CAACG,GAAG,CAAC,cAAc,CAAC;MACxD,IAAIlD,IAAI;MAER,IAAIiD,WAAW,IAAIA,WAAW,CAACE,QAAQ,CAAC,kBAAkB,CAAC,EAAE;QAC3DnD,IAAI,GAAG,MAAMoC,QAAQ,CAACE,IAAI,CAAC,CAAC;MAC9B,CAAC,MAAM;QACL,MAAMc,IAAI,GAAG,MAAMhB,QAAQ,CAACgB,IAAI,CAAC,CAAC;QAClCvD,OAAO,CAACtB,KAAK,CAAC,oCAAoC,EAAE6E,IAAI,CAAC;QACzD,MAAM,IAAIC,KAAK,CAAC,qCAAqC,CAAC;MACxD;MAEA,IAAI,CAACjB,QAAQ,CAACC,EAAE,EAAE;QAChB;QACA,IAAID,QAAQ,CAACkB,MAAM,KAAK,GAAG,EAAE;UAC3B;UACArE,YAAY,CAACU,UAAU,CAAC,OAAO,CAAC;UAChCV,YAAY,CAACC,OAAO,CAAC,oBAAoB,EAAE,gBAAgB,CAAC;UAC5DV,QAAQ,CAAC,qDAAqD,CAAC;UAC/DiE,UAAU,CAAC,MAAM;YACfxF,QAAQ,CAAC,QAAQ,CAAC;UACpB,CAAC,EAAE,IAAI,CAAC;UACR;QACF;QAEA,MAAM,IAAIoG,KAAK,CAACrD,IAAI,CAACuD,OAAO,IAAI,yBAAyB,CAAC;MAC5D;;MAEA;MACA7E,UAAU,CAAC,IAAI,CAAC;;MAEhB;MACA,MAAM8E,QAAQ,IAAAhB,WAAA,GAAGxC,IAAI,CAACA,IAAI,cAAAwC,WAAA,uBAATA,WAAA,CAAWiB,EAAE;MAC9B5D,OAAO,CAACQ,GAAG,CAAC,yBAAyB,EAAEmD,QAAQ,CAAC;MAEhD,IAAI,CAACA,QAAQ,EAAE;QACb3D,OAAO,CAACtB,KAAK,CAAC,kCAAkC,EAAEyB,IAAI,CAAC;MACzD;;MAEA;MACAyC,UAAU,CAAC,MAAM;QACfxF,QAAQ,CAAC,WAAWuG,QAAQ,EAAE,CAAC;MACjC,CAAC,EAAE,IAAI,CAAC;IAEV,CAAC,CAAC,OAAOjF,KAAK,EAAE;MACdsB,OAAO,CAACtB,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;MAC9CC,QAAQ,CAACD,KAAK,CAACgF,OAAO,IAAI,oCAAoC,CAAC;IACjE,CAAC,SAAS;MACR3E,eAAe,CAAC,KAAK,CAAC;IACxB;EACF,CAAC;;EAEG;EACA,MAAM8E,eAAe,GAAG,MAAAA,CAAA,KAAY;IAChC,IAAI,CAACxG,KAAK,EAAE;MACRsB,QAAQ,CAAC,0BAA0B,CAAC;MACpC;IACJ;IAEA,IAAI;MACAF,UAAU,CAAC,IAAI,CAAC;MAChBE,QAAQ,CAAC,IAAI,CAAC;;MAEd;MACA,MAAMO,KAAK,GAAGrC,YAAY,CAAC,CAAC;MAC5B,IAAI,CAACqC,KAAK,EAAE;QACRP,QAAQ,CAAC,6CAA6C,CAAC;QACvDF,UAAU,CAAC,KAAK,CAAC;QACjB;MACJ;;MAEA;MACA,MAAMgB,QAAQ,GAAG,IAAIoD,QAAQ,CAAC,CAAC;MAC/BpD,QAAQ,CAACqD,MAAM,CAAC,OAAO,EAAEzF,KAAK,CAAC;MAC/BoC,QAAQ,CAACqD,MAAM,CAAC,aAAa,EAAEnF,WAAW,IAAI,GAAG,CAAC;MAClD8B,QAAQ,CAACqD,MAAM,CAAC,UAAU,EAAEjF,QAAQ,IAAI,EAAE,CAAC;MAC3C4B,QAAQ,CAACqD,MAAM,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC,CAAC;;MAEpC;MACA,IAAIvF,KAAK,EAAE;QACPkC,QAAQ,CAACqD,MAAM,CAAC,OAAO,EAAEvF,KAAK,CAAC;MACnC;;MAEA;MACAkC,QAAQ,CAACqD,MAAM,CAAC,aAAa,EAAEpD,IAAI,CAACa,SAAS,CAACxC,WAAW,CAAC,CAAC;;MAE3D;MACA,MAAM+F,SAAS,GAAG1F,KAAK,CAACwB,GAAG,CAACC,IAAI,KAAK;QAAEvB,WAAW,EAAEuB,IAAI,CAACvB,WAAW,IAAI;MAAG,CAAC,CAAC,CAAC;MAC9EmB,QAAQ,CAACqD,MAAM,CAAC,OAAO,EAAEpD,IAAI,CAACa,SAAS,CAACuD,SAAS,CAAC,CAAC;;MAEnD;MACA1F,KAAK,CAAC2E,OAAO,CAAC,CAAClD,IAAI,EAAEe,KAAK,KAAK;QAC3B,IAAIf,IAAI,CAACtC,KAAK,EAAE;UACZkC,QAAQ,CAACqD,MAAM,CAAC,eAAelC,KAAK,GAAG,EAAEf,IAAI,CAACtC,KAAK,CAAC;QACxD;QACA,IAAIsC,IAAI,CAACtB,KAAK,EAAE;UACZkB,QAAQ,CAACqD,MAAM,CAAC,eAAelC,KAAK,GAAG,EAAEf,IAAI,CAACtB,KAAK,CAAC;QACxD;MACJ,CAAC,CAAC;MAEF,MAAMgE,QAAQ,GAAG,MAAMS,KAAK,CAAC,yCAAyC,EAAE;QACpEC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACL,eAAe,EAAE,UAAUhE,KAAK;QACpC,CAAC;QACDiE,IAAI,EAAE1D;MACV,CAAC,CAAC;MAEF,IAAI8C,QAAQ,CAACC,EAAE,EAAE;QACb,MAAMR,MAAM,GAAG,MAAMO,QAAQ,CAACE,IAAI,CAAC,CAAC;;QAEpC;QACArD,YAAY,CAACU,UAAU,CAAC,gBAAgB,CAAC;QACzCV,YAAY,CAACU,UAAU,CAAC,mBAAmB,CAAC;;QAE5C;QACAX,KAAK,CAAC,0CAA0C,CAAC;;QAEjD;QACA/B,QAAQ,CAAC,YAAY,CAAC;MAC1B,CAAC,MAAM;QACH,MAAM4E,MAAM,GAAG,MAAMO,QAAQ,CAACE,IAAI,CAAC,CAAC;QACpC,MAAM,IAAIe,KAAK,CAACxB,MAAM,CAAC0B,OAAO,IAAI,sBAAsB,CAAC;MAC7D;IACJ,CAAC,CAAC,OAAOhF,KAAK,EAAE;MACZC,QAAQ,CAAC,QAAQD,KAAK,CAACgF,OAAO,EAAE,CAAC;MACjC1D,OAAO,CAACtB,KAAK,CAAC,qBAAqB,EAAEA,KAAK,CAAC;IAC/C,CAAC,SAAS;MACND,UAAU,CAAC,KAAK,CAAC;IACrB;EACJ,CAAC;;EAED;EACA,MAAMsF,YAAY,GAAG,MAAOhE,CAAC,IAAK;IAC9BA,CAAC,CAACiE,cAAc,CAAC,CAAC;IAElB,IAAI;MACA;MACA,MAAMC,UAAU,GAAG;QACjB5G,KAAK;QACLM,WAAW;QACXI,WAAW;QACXK,KAAK;QACLP;MACF,CAAC;MACDuB,YAAY,CAACC,OAAO,CAAC,cAAc,EAAEK,IAAI,CAACa,SAAS,CAAC0D,UAAU,CAAC,CAAC;MAEhElF,eAAe,CAAC,IAAI,CAAC;;MAErB;MACA,MAAMU,QAAQ,GAAG,IAAIoD,QAAQ,CAAC,CAAC;MAC/BpD,QAAQ,CAACqD,MAAM,CAAC,OAAO,EAAEzF,KAAK,CAAC;MAC/BoC,QAAQ,CAACqD,MAAM,CAAC,aAAa,EAAEnF,WAAW,CAAC;MAC3C8B,QAAQ,CAACqD,MAAM,CAAC,UAAU,EAAEjF,QAAQ,CAAC;MACrC4B,QAAQ,CAACqD,MAAM,CAAC,QAAQ,EAAE,WAAW,CAAC;;MAEtC;MACA,IAAIvF,KAAK,EAAE;QACTkC,QAAQ,CAACqD,MAAM,CAAC,OAAO,EAAEvF,KAAK,CAAC;MACjC;;MAEA;MACAkC,QAAQ,CAACqD,MAAM,CAAC,aAAa,EAAEpD,IAAI,CAACa,SAAS,CAACxC,WAAW,CAAC,CAAC;;MAE3D;MACA0B,QAAQ,CAACqD,MAAM,CAAC,OAAO,EAAEpD,IAAI,CAACa,SAAS,CAACnC,KAAK,CAACwB,GAAG,CAACC,IAAI,KAAK;QACzDvB,WAAW,EAAEuB,IAAI,CAACvB;MACpB,CAAC,CAAC,CAAC,CAAC,CAAC;;MAEL;MACAF,KAAK,CAAC2E,OAAO,CAAC,CAAClD,IAAI,EAAEe,KAAK,KAAK;QAC7B,IAAIf,IAAI,CAACtC,KAAK,EAAE;UACdkC,QAAQ,CAACqD,MAAM,CAAC,eAAelC,KAAK,GAAG,EAAEf,IAAI,CAACtC,KAAK,CAAC;QACtD;QACA,IAAIsC,IAAI,CAACtB,KAAK,EAAE;UACdkB,QAAQ,CAACqD,MAAM,CAAC,eAAelC,KAAK,GAAG,EAAEf,IAAI,CAACtB,KAAK,CAAC;QACtD;MACF,CAAC,CAAC;;MAEF;MACA,MAAMW,KAAK,GAAGE,YAAY,CAACG,OAAO,CAAC,YAAY,CAAC,CAAC,CAAC;;MAElD;MACA,IAAI,CAACL,KAAK,EAAE;QACVP,QAAQ,CAAC,4DAA4D,CAAC;QACtES,YAAY,CAACU,UAAU,CAAC,MAAM,CAAC;QAC/B1C,QAAQ,CAAC,QAAQ,CAAC;QAClB;MACF;MAEA,MAAMmF,QAAQ,GAAG,MAAMS,KAAK,CAAC,mCAAmC,EAAE;QAChEC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACP,eAAe,EAAE,UAAUhE,KAAK;QAClC,CAAC;QACDiE,IAAI,EAAE1D;MACR,CAAC,CAAC;MAEF,IAAI8C,QAAQ,CAACC,EAAE,EAAE;QACf,MAAMrC,IAAI,GAAG,MAAMoC,QAAQ,CAACE,IAAI,CAAC,CAAC;QAClCtD,KAAK,CAAC,mCAAmC,CAAC;QAC1C/B,QAAQ,CAAC,WAAW+C,IAAI,CAACyD,EAAE,EAAE,CAAC;MAChC,CAAC,MAAM;QACL;QACA,MAAMM,SAAS,GAAG,MAAM3B,QAAQ,CAACE,IAAI,CAAC,CAAC;;QAEvC;QACA,IAAIF,QAAQ,CAACkB,MAAM,KAAK,GAAG,EAAE;UAC3B9E,QAAQ,CAAC,qDAAqD,CAAC;UAC/DS,YAAY,CAACU,UAAU,CAAC,YAAY,CAAC;UACrCV,YAAY,CAACU,UAAU,CAAC,MAAM,CAAC;UAC/B8C,UAAU,CAAC,MAAMxF,QAAQ,CAAC,QAAQ,CAAC,EAAE,IAAI,CAAC;UAC1C;QACF;QAEAuB,QAAQ,CAACuF,SAAS,CAACR,OAAO,IAAI,kCAAkC,CAAC;MACnE;IACJ,CAAC,CAAC,OAAOS,GAAG,EAAE;MACVnE,OAAO,CAACtB,KAAK,CAAC,wBAAwB,EAAEyF,GAAG,CAAC;MAC5CxF,QAAQ,CAAC,+CAA+C,CAAC;IAC7D,CAAC,SAAS;MACNI,eAAe,CAAC,KAAK,CAAC;IAC1B;EACJ,CAAC;EAED,oBACI9B,OAAA;IAAKmH,SAAS,EAAC,oBAAoB;IAAAC,QAAA,gBAC/BpH,OAAA;MAAAoH,QAAA,EAAI;IAAiB;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,EAEzB/F,KAAK,iBAChBzB,OAAA;MAAKmH,SAAS,EAAC,eAAe;MAAAC,QAAA,gBAC5BpH,OAAA;QAAGmH,SAAS,EAAC;MAA2B;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,EAC5C/F,KAAK;IAAA;MAAA4F,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CACN,EAEAzF,UAAU,iBACT/B,OAAA;MAAKmH,SAAS,EAAC,SAAS;MAAAC,QAAA,eACtBpH,OAAA;QAAKmH,SAAS,EAAC,iBAAiB;QAAAC,QAAA,gBAC9BpH,OAAA;UAAKmH,SAAS,EAAC;QAAS;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,eAC/BxH,OAAA;UAAAoH,QAAA,EAAG;QAAqB;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACzB;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CACN,EAEY7F,OAAO,iBAAI3B,OAAA;MAAKmH,SAAS,EAAC,iBAAiB;MAAAC,QAAA,EAAC;IAAkC;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC,eAErFxH,OAAA;MAAMyH,QAAQ,EAAEX,YAAa;MAACK,SAAS,EAAC,aAAa;MAACO,OAAO,EAAC,qBAAqB;MAAAN,QAAA,gBAE/EpH,OAAA;QAAKmH,SAAS,EAAC,YAAY;QAAAC,QAAA,gBACvBpH,OAAA;UAAO2H,OAAO,EAAC,OAAO;UAAAP,QAAA,EAAC;QAAY;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eAC3CxH,OAAA;UACI0E,IAAI,EAAC,MAAM;UACXiC,EAAE,EAAC,OAAO;UACVxC,KAAK,EAAE/D,KAAM;UACbwH,QAAQ,EAAG9E,CAAC,IAAKzC,QAAQ,CAACyC,CAAC,CAACyB,MAAM,CAACJ,KAAK,CAAE;UAC1C0D,WAAW,EAAC,iCAAiB;UAC7BC,QAAQ;QAAA;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACX,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD,CAAC,eAGNxH,OAAA;QAAKmH,SAAS,EAAC,YAAY;QAAAC,QAAA,gBACvBpH,OAAA;UAAO2H,OAAO,EAAC,OAAO;UAAAP,QAAA,EAAC;QAAe;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eAC9CxH,OAAA;UACI0E,IAAI,EAAC,MAAM;UACXiC,EAAE,EAAC,OAAO;UACVoB,MAAM,EAAC,SAAS;UAChBH,QAAQ,EAAE1C;QAAkB;UAAAmC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC/B,CAAC,EACDhH,YAAY,iBACTR,OAAA;UAAKmH,SAAS,EAAC,eAAe;UAAAC,QAAA,eAC1BpH,OAAA;YAAKgI,GAAG,EAAExH,YAAa;YAACyH,GAAG,EAAC;UAAW;YAAAZ,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACzC,CACR;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACA,CAAC,eAGNxH,OAAA;QAAKmH,SAAS,EAAC,YAAY;QAAAC,QAAA,gBACvBpH,OAAA;UAAO2H,OAAO,EAAC,aAAa;UAAAP,QAAA,EAAC;QAAsB;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eAC3DxH,OAAA;UACI0E,IAAI,EAAC,QAAQ;UACbiC,EAAE,EAAC,aAAa;UAChBxC,KAAK,EAAEzD,WAAY;UACnBkH,QAAQ,EAAG9E,CAAC,IAAKnC,cAAc,CAACmC,CAAC,CAACyB,MAAM,CAACJ,KAAK,CAAE;UAChD+D,GAAG,EAAC,GAAG;UACPL,WAAW,EAAC,mCAAoB;UAChCC,QAAQ;QAAA;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACX,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD,CAAC,eAGNxH,OAAA;QAAKmH,SAAS,EAAC,YAAY;QAAAC,QAAA,gBACvBpH,OAAA;UAAAoH,QAAA,EAAI;QAAa;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,EACrB1G,WAAW,CAAC6B,GAAG,CAAC,CAACwF,UAAU,EAAExE,KAAK,kBAC/B3D,OAAA;UAAiBmH,SAAS,EAAC,gBAAgB;UAAAC,QAAA,gBACvCpH,OAAA;YACI0E,IAAI,EAAC,MAAM;YACXmD,WAAW,EAAC,4BAAiB;YAC7B1D,KAAK,EAAEgE,UAAU,CAACnH,IAAK;YACvB4G,QAAQ,EAAG9E,CAAC,IAAKmB,sBAAsB,CAACN,KAAK,EAAE,MAAM,EAAEb,CAAC,CAACyB,MAAM,CAACJ,KAAK,CAAE;YACvE2D,QAAQ;UAAA;YAAAT,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACX,CAAC,eACFxH,OAAA;YACI0E,IAAI,EAAC,MAAM;YACXmD,WAAW,EAAC,yBAAU;YACtB1D,KAAK,EAAEgE,UAAU,CAAClH,QAAS;YAC3B2G,QAAQ,EAAG9E,CAAC,IAAKmB,sBAAsB,CAACN,KAAK,EAAE,UAAU,EAAEb,CAAC,CAACyB,MAAM,CAACJ,KAAK,CAAE;YAC3E2D,QAAQ;UAAA;YAAAT,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACX,CAAC,eACFxH,OAAA;YACI0E,IAAI,EAAC,MAAM;YACXmD,WAAW,EAAC,kCAAmB;YAC/B1D,KAAK,EAAEgE,UAAU,CAACjH,IAAK;YACvB0G,QAAQ,EAAG9E,CAAC,IAAKmB,sBAAsB,CAACN,KAAK,EAAE,MAAM,EAAEb,CAAC,CAACyB,MAAM,CAACJ,KAAK;UAAE;YAAAkD,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC1E,CAAC,EACD1G,WAAW,CAACuC,MAAM,GAAG,CAAC,iBACnBrD,OAAA;YACI0E,IAAI,EAAC,QAAQ;YACbyC,SAAS,EAAC,YAAY;YACtBiB,OAAO,EAAEA,CAAA,KAAM1E,sBAAsB,CAACC,KAAK,CAAE;YAAAyD,QAAA,eAE7CpH,OAAA;cAAGmH,SAAS,EAAC;YAAc;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC5B,CACX;QAAA,GA7BK7D,KAAK;UAAA0D,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OA8BV,CACR,CAAC,eACFxH,OAAA;UAAQ0E,IAAI,EAAC,QAAQ;UAACyC,SAAS,EAAC,SAAS;UAACiB,OAAO,EAAE3E,mBAAoB;UAAA2D,QAAA,gBACnEpH,OAAA;YAAGmH,SAAS,EAAC;UAAa;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,gCACnC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACR,CAAC,eAGNxH,OAAA;QAAKmH,SAAS,EAAC,YAAY;QAAAC,QAAA,gBACvBpH,OAAA;UAAAoH,QAAA,EAAI;QAAU;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,EAClBrG,KAAK,CAACwB,GAAG,CAAC,CAACC,IAAI,EAAEe,KAAK,kBACnB3D,OAAA;UAAiBmH,SAAS,EAAC,UAAU;UAAAC,QAAA,gBACjCpH,OAAA;YAAKmH,SAAS,EAAC,aAAa;YAAAC,QAAA,gBACxBpH,OAAA;cAAMmH,SAAS,EAAC,aAAa;cAAAC,QAAA,GAAC,iBAAK,EAACzD,KAAK,GAAG,CAAC;YAAA;cAAA0D,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,EACpDrG,KAAK,CAACkC,MAAM,GAAG,CAAC,iBACbrD,OAAA;cACI0E,IAAI,EAAC,QAAQ;cACbyC,SAAS,EAAC,YAAY;cACtBiB,OAAO,EAAEA,CAAA,KAAMrE,gBAAgB,CAACJ,KAAK,CAAE;cAAAyD,QAAA,eAEvCpH,OAAA;gBAAGmH,SAAS,EAAC;cAAc;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAC5B,CACX;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACA,CAAC,eACNxH,OAAA;YACI6H,WAAW,EAAE,2BAA2BlE,KAAK,GAAG,CAAC,EAAG;YACpDQ,KAAK,EAAEvB,IAAI,CAACvB,WAAW,IAAI,EAAG;YAC9BuG,QAAQ,EAAG9E,CAAC,IAAKsB,gBAAgB,CAACT,KAAK,EAAEb,CAAC,CAACyB,MAAM,CAACJ,KAAK,CAAE;YACzD2D,QAAQ;YACRO,IAAI,EAAC;UAAG;YAAAhB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACX,CAAC,eACFxH,OAAA;YAAKmH,SAAS,EAAC,YAAY;YAAAC,QAAA,gBACvBpH,OAAA;cAAKmH,SAAS,EAAC,aAAa;cAAAC,QAAA,gBACxBpH,OAAA;gBAAAoH,QAAA,gBACIpH,OAAA;kBAAGmH,SAAS,EAAC;gBAAc;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,6BAChC,eAAAxH,OAAA;kBACI0E,IAAI,EAAC,MAAM;kBACXqD,MAAM,EAAC,SAAS;kBAChBH,QAAQ,EAAG9E,CAAC,IAAKuB,qBAAqB,CAACV,KAAK,EAAEb,CAAC,CAAE;kBACjDwF,KAAK,EAAE;oBAACC,OAAO,EAAE;kBAAM;gBAAE;kBAAAlB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAC5B,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACC,CAAC,eACRxH,OAAA;gBAAAoH,QAAA,gBACIpH,OAAA;kBAAGmH,SAAS,EAAC;gBAAc;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,kBAChC,eAAAxH,OAAA;kBACI0E,IAAI,EAAC,MAAM;kBACXqD,MAAM,EAAC,SAAS;kBAChBH,QAAQ,EAAG9E,CAAC,IAAKmC,qBAAqB,CAACtB,KAAK,EAAEb,CAAC,CAAE;kBACjDwF,KAAK,EAAE;oBAACC,OAAO,EAAE;kBAAM;gBAAE;kBAAAlB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAC5B,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACC,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACP,CAAC,EAEL5E,IAAI,CAACpC,YAAY,iBACdR,OAAA;cAAKmH,SAAS,EAAC,eAAe;cAAAC,QAAA,gBAC1BpH,OAAA;gBAAKgI,GAAG,EAAEpF,IAAI,CAACpC,YAAa;gBAACyH,GAAG,EAAE,QAAQtE,KAAK,GAAG,CAAC;cAAG;gBAAA0D,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,eACzDxH,OAAA;gBACI0E,IAAI,EAAC,QAAQ;gBACbyC,SAAS,EAAC,kBAAkB;gBAC5BiB,OAAO,EAAEA,CAAA,KAAM;kBACX,MAAMpE,QAAQ,GAAG,CAAC,GAAG7C,KAAK,CAAC;kBAC3B6C,QAAQ,CAACL,KAAK,CAAC,CAACrD,KAAK,GAAG,IAAI;kBAC5B0D,QAAQ,CAACL,KAAK,CAAC,CAACnD,YAAY,GAAG,IAAI;kBACnCY,QAAQ,CAAC4C,QAAQ,CAAC;gBACtB,CAAE;gBAAAoD,QAAA,eAEFpH,OAAA;kBAAGmH,SAAS,EAAC;gBAAc;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC5B,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACR,CACR,EAEA5E,IAAI,CAACtB,KAAK,iBACPtB,OAAA;cAAKmH,SAAS,EAAC,eAAe;cAAAC,QAAA,eAC1BpH,OAAA;gBAAKmH,SAAS,EAAC,YAAY;gBAAAC,QAAA,gBACvBpH,OAAA;kBAAGmH,SAAS,EAAC;gBAAa;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eAC/BxH,OAAA;kBAAAoH,QAAA,EAAOxE,IAAI,CAACtB,KAAK,CAACN;gBAAI;kBAAAqG,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAO,CAAC,eAC9BxH,OAAA;kBACI0E,IAAI,EAAC,QAAQ;kBACbyC,SAAS,EAAC,kBAAkB;kBAC5BiB,OAAO,EAAEA,CAAA,KAAM;oBACX,MAAMpE,QAAQ,GAAG,CAAC,GAAG7C,KAAK,CAAC;oBAC3B6C,QAAQ,CAACL,KAAK,CAAC,CAACrC,KAAK,GAAG,IAAI;oBAC5BF,QAAQ,CAAC4C,QAAQ,CAAC;kBACtB,CAAE;kBAAAoD,QAAA,eAEFpH,OAAA;oBAAGmH,SAAS,EAAC;kBAAc;oBAAAE,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI;gBAAC;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAC5B,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACR;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACL,CACR;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACA,CAAC;QAAA,GA/EA7D,KAAK;UAAA0D,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAgFV,CACR,CAAC,eACFxH,OAAA;UAAQ0E,IAAI,EAAC,QAAQ;UAACyC,SAAS,EAAC,SAAS;UAACiB,OAAO,EAAEtE,aAAc;UAAAsD,QAAA,gBAC7DpH,OAAA;YAAGmH,SAAS,EAAC;UAAa;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,2BACnC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACR,CAAC,eAGNxH,OAAA;QAAKmH,SAAS,EAAC,YAAY;QAAAC,QAAA,gBACvBpH,OAAA;UAAO2H,OAAO,EAAC,UAAU;UAAAP,QAAA,EAAC;QAA8B;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eAChExH,OAAA;UACI2G,EAAE,EAAC,UAAU;UACbxC,KAAK,EAAEvD,QAAQ,IAAI,EAAG;UACtBgH,QAAQ,EAAG9E,CAAC,IAAKjC,WAAW,CAACiC,CAAC,CAACyB,MAAM,CAACJ,KAAK,CAAE;UAC7C0D,WAAW,EAAC,wGAAuD;UACnEQ,IAAI,EAAE;QAAE;UAAAhB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACX,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD,CAAC,eAGNxH,OAAA;QAAKmH,SAAS,EAAC,cAAc;QAAAC,QAAA,gBACzBpH,OAAA;UACI0E,IAAI,EAAC,QAAQ;UACbyC,SAAS,EAAC,kBAAkB;UAC5BqB,QAAQ,EAAEjH,OAAQ;UAClB6G,OAAO,EAAExB,eAAgB;UAAAQ,QAAA,gBAEzBpH,OAAA;YAAGmH,SAAS,EAAC;UAAa;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,8BACnC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eAETxH,OAAA;UACI0E,IAAI,EAAC,QAAQ;UACbyC,SAAS,EAAC,gBAAgB;UAC1BqB,QAAQ,EAAEjH,OAAO,IAAIM,YAAa;UAAAuF,QAAA,gBAElCpH,OAAA;YAAGmH,SAAS,EAAC;UAAoB;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,KAAC,EAACjG,OAAO,GAAG,eAAe,GAAG,gBAAgB;QAAA;UAAA8F,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAChF,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACR,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACJ,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACN,CAAC;AAEd,CAAC;AAACtH,EAAA,CAtxBID,gBAAgB;EAAA,QACDN,WAAW;AAAA;AAAA8I,EAAA,GAD1BxI,gBAAgB;AAwxBtB,eAAeA,gBAAgB;AAAC,IAAAwI,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}